/*
 *  This file is part of Cosmos Journeyer
 *
 *  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

"use strict";(globalThis.webpackChunkcosmos_journeyer=globalThis.webpackChunkcosmos_journeyer||[]).push([["5584"],{43808:function(e,t,n){e.exports=n.p+"fd7997898bbeb1f1.wasm"},78996:function(e,t,n){e.exports=n.p+"869739fc3ede15e2.js"},80247:function(e,t,n){n.d(t,{Vj:()=>l,Yn:()=>s,oC:()=>d,z0:()=>u});var r=n(78479),a=n(69427),i=n(29375),o=i.Dx;function s(e,t){return(0,i.bw)(e,t)}function u(e){var t=window.location.href.split("?")[0],n=(0,a.o)(JSON.stringify(e));return null===n?null:new URL("".concat(t,"?save=").concat(n))}function l(e,t){var n=[],r=[],a=!0,i=!1,o=void 0;try{for(var u,l=e[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value,d=s(c,t);d.success?n.push(d.value):r.push({save:c,error:d.error})}}catch(e){i=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}return{validSaves:n,invalidSaves:r}}var c=r.z.object({manual:r.z.array(r.z.record(r.z.string(),r.z.unknown())),auto:r.z.array(r.z.record(r.z.string(),r.z.unknown()))});c.extend({manual:r.z.array(o),auto:r.z.array(o)});var d=r.z.record(r.z.string().uuid(),c)},32133:function(e,t,n){n.d(t,{M:()=>o,b:()=>i});var r,a=n(32075),i=((r={}).INVALID_JSON="INVALID_JSON",r.INVALID_SAVE="INVALID_SAVE",r.INVALID_STORAGE_FORMAT="INVALID_STORAGE_FORMAT",r);function o(e){switch(e.type){case"INVALID_JSON":return a.Z.t("notifications:invalidSaveFileJson");case"INVALID_SAVE":return a.Z.t("notifications:invalidSaveFile");case"INVALID_STORAGE_FORMAT":return a.Z.t("notifications:invalidStorageFormat")}}},70541:function(e,t,n){n.d(t,{vG:()=>f});var r=n(85737),a=n(16585),i=n(76473),o=(0,a.c)(i.Z.POWER_PLAY_SEED),s=0,u=(0,r.makeNoise3D)(function(){return o(s++)}),l=(0,a.c)(i.Z.POWER_PLAY_SEED+598),c=0,d=(0,r.makeNoise3D)(function(){return l(c++)});function f(e){var t,n;return{materialistSpiritualist:(t=e.x,.5*u(.2*t,.2*e.y,.2*e.z)+.5),capitalistCommunist:(n=e.x,.5*d(.2*n,.2*e.y,.2*e.z)+.5)}}},35533:function(e,t,n){n.d(t,{j:()=>X}),n(38378),n(15922);var r=n(17816),a=n(13405),i=n(94394),o=n(55710),s=n(20540),u=n(96656),l=n(84490),c=n(59908),d=n(50344),f=n(72467),h=n(6725),v=n(85265),p=n(12078),m=n(78114),y=n(51622),b=n(94080),g=n(98462),S=n(95881),w=n(34007),E=n(32235),P=n(46017),C=n(41466),T=n(33541),A=n(97132),L=n(51335),O=n(28080),I=n(885),k=n(30101),M=n(48689),R=n(67942),V=n(68098),D=n(42137),N=n(15411),x=n(12285),_=n(19189),B=n(37235),j=n(22573),U=n(78883),G=n(57699),F=n(25043),W=n(73493),Z=n(66063),z=n(2906),Y=n(78093),K=n(83177);function H(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function X(e,t){return J.apply(this,arguments)}function J(){var e;return e=function(e,t){var n,H,X,J,q,Q,$,ee,et,en,er,ea,ei,eo,es,eu,el,ec,ed,ef,eh,ev,ep,em,ey,eb,eg,eS,ew,eE,eP,eC,eT,eA,eL,eO,eI,ek,eM,eR,eV,eD,eN,ex,e_,eB,ej,eU,eG,eF,eW,eZ,ez,eY,eK,eH,eX;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(eJ){switch(eJ.label){case 0:return n=0,H=0,X=function(r,i){var o=new Promise(function(e){var n=new a.x(i,t,!1,!1,void 0,function(){e(n)});n.name=r});return H++,o.then(function(t){return e(++n,H,t.name),t})},J=function(a,i){var o=new Promise(function(e){var n=r.B.CreateFromPrefilteredData(i,t);n.onLoadObservable.add(function(){e(n)}),n.name=a});return H++,o.then(function(t){return e(++n,H,t.name),t})},q=X("RockNormalMetallicMap",R),Q=X("RockAlbedoRoughnessMap",M),$=X("GrassNormalMetallicMap",E),ee=X("GrassAlbedoRoughnessMap",w),et=X("SnowNormalMetallicMap",C),en=X("SnowAlbedoRoughness",P),er=X("SandNormalMetallicMap",D),ea=X("SandAlbedoRoughnessMap",V),ei=X("WaterNormalMap1",z),eo=X("WaterNormalMap2",Y),es=X("PlumeParticle",Z),eu=X("FlareTexture",S),el=X("Butterfly",d),ec=X("EmptyTexture",I),ed=X("SeamlessPerlin",k),ef=J("SkyBox",N),eh=X("SolarPanelAlbedo",_),ev=X("SolarPanelNormal",B),ep=X("SolarPanelMetallicRoughness",x),em=X("SpaceStationAlbedo",U),ey=X("SpaceStationNormal",F),eb=X("SpaceStationMetallicRoughness",j),eg=X("SpaceStationAmbientOcclusion",G),eS=X("MetalPanelsAlbedo",A),ew=X("MetalPanelsNormal",O),eE=X("MetalPanelsMetallicRoughness",T),eP=X("MetalPanelsAmbientOcclusion",L),eC=X("TreeAlbedo",K),eT=X("ConcreteAlbedo",m),eA=X("ConcreteNormal",g),eL=X("ConcreteMetallicRoughness",b),eO=X("ConcreteAmbientOcclusion",y),eI=X("CrateAlbedo",f),ek=X("CrateNormal",p),eM=X("CrateMetallicRoughness",v),eR=X("CrateAmbientOcclusion",h),[4,eC];case 1:return(eV=eJ.sent()).hasAlpha=!0,eD={},eN={},ex={},[4,q];case 2:return ex.normalMetallic=eJ.sent(),[4,Q];case 3:return eN.rock=(ex.albedoRoughness=eJ.sent(),ex),e_={},[4,$];case 4:return e_.normalMetallic=eJ.sent(),[4,ee];case 5:return eN.grass=(e_.albedoRoughness=eJ.sent(),e_),eB={},[4,et];case 6:return eB.normalMetallic=eJ.sent(),[4,en];case 7:return eN.snow=(eB.albedoRoughness=eJ.sent(),eB),ej={},[4,er];case 8:return ej.normalMetallic=eJ.sent(),[4,ea];case 9:return eD.terrains=(eN.sand=(ej.albedoRoughness=eJ.sent(),ej),eN),eU={},[4,ei];case 10:return eU.normalMap1=eJ.sent(),[4,eo];case 11:return eD.water=(eU.normalMap2=eJ.sent(),eU),eG={},[4,es];case 12:return eG.plume=eJ.sent(),[4,eu];case 13:return eG.flare=eJ.sent(),[4,el];case 14:return eD.particles=(eG.butterfly=eJ.sent(),eG),eF={},eW={},[4,eh];case 15:return eW.albedo=eJ.sent(),[4,ev];case 16:return eW.normal=eJ.sent(),[4,ep];case 17:return eF.solarPanel=(eW.metallicRoughness=eJ.sent(),eW),eZ={},[4,em];case 18:return eZ.albedo=eJ.sent(),[4,ey];case 19:return eZ.normal=eJ.sent(),[4,eb];case 20:return eZ.metallicRoughness=eJ.sent(),[4,eg];case 21:return eF.spaceStation=(eZ.ambientOcclusion=eJ.sent(),eZ),ez={},[4,eS];case 22:return ez.albedo=eJ.sent(),[4,ew];case 23:return ez.normal=eJ.sent(),[4,eE];case 24:return ez.metallicRoughness=eJ.sent(),[4,eP];case 25:return eF.metalPanels=(ez.ambientOcclusion=eJ.sent(),ez),eY={},[4,eT];case 26:return eY.albedo=eJ.sent(),[4,eA];case 27:return eY.normal=eJ.sent(),[4,eL];case 28:return eY.metallicRoughness=eJ.sent(),[4,eO];case 29:return eF.concrete=(eY.ambientOcclusion=eJ.sent(),eY),eK={},[4,eI];case 30:return eK.albedo=eJ.sent(),[4,ek];case 31:return eK.normal=eJ.sent(),[4,eM];case 32:return eK.metallicRoughness=eJ.sent(),[4,eR];case 33:return eD.materials=(eF.crate=(eK.ambientOcclusion=eJ.sent(),eK),eF.tree={albedo:eV},eF),eH={},[4,ef];case 34:return eD.environment=(eH.milkyWay=eJ.sent(),eH),eX={},[4,ed];case 35:return eD.noises=(eX.seamlessPerlin=eJ.sent(),eX),eD.ui={cursorImageUrl:W},[4,ec];case 36:var eq;return[2,(eD.empty=eJ.sent(),eD.pools=(eq=t,{cloudsLut:new l._(function(){return new i.E(eq)}),ringsLut:new l._(function(){return new o.l(eq)}),starMaterialLut:new l._(function(){return new u.u(eq)}),telluricPlanetMaterialLut:new l._(function(){return new s.T(eq)}),landingPad:new c.h}),eD)]}})},(J=function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){H(i,r,a,o,s,"next",e)}function s(e){H(i,r,a,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}},4761:function(e,t,n){n.d(t,{Ae:()=>u,bM:()=>o,eU:()=>s});function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a,i,o=((a={})[a.CHARLOTTE=0]="CHARLOTTE",a),s=((i={})[i.INITIATING_PLANETARY_LANDING=0]="INITIATING_PLANETARY_LANDING",i[i.LANDING_REQUEST_GRANTED=1]="LANDING_REQUEST_GRANTED",i[i.LANDING_COMPLETE=2]="LANDING_COMPLETE",i[i.MISSION_COMPLETE=3]="MISSION_COMPLETE",i[i.NEW_DISCOVERY=4]="NEW_DISCOVERY",i[i.CANNOT_ENGAGE_WARP_DRIVE=5]="CANNOT_ENGAGE_WARP_DRIVE",i[i.WARP_DRIVE_EMERGENCY_SHUT_DOWN=6]="WARP_DRIVE_EMERGENCY_SHUT_DOWN",i[i.WARP_DRIVE_DISENGAGED=7]="WARP_DRIVE_DISENGAGED",i[i.ENGAGING_WARP_DRIVE=8]="ENGAGING_WARP_DRIVE",i[i.FUEL_SCOOPING=9]="FUEL_SCOOPING",i[i.FUEL_SCOOPING_COMPLETE=10]="FUEL_SCOOPING_COMPLETE",i),u=function(){var e;function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");r(this,"voiceLines",void 0),r(this,"isPlaying",!1),r(this,"soundQueue",[]),this.voiceLines=e}return e=[{key:"getLineFromVoiceLines",value:function(e,t){switch(t){case 0:return e.initiatingPlanetaryLanding;case 1:return e.landingRequestGranted;case 2:return e.landingComplete;case 3:return e.missionComplete;case 4:return e.newDiscovery;case 5:return e.cannotEngageWarpDrive;case 6:return e.warpDriveEmergencyShutDown;case 7:return e.warpDriveDisengaged;case 8:return e.engagingWarpDrive;case 9:return e.fuelScooping;case 10:return e.fuelScoopingComplete}}},{key:"getVoiceLinesFromSpeaker",value:function(e){if(0===e)return this.voiceLines.charlotte}},{key:"sayNow",value:function(e,t){this.getLineFromVoiceLines(this.getVoiceLinesFromSpeaker(e),t).play()}},{key:"enqueueSay",value:function(e,t){this.soundQueue.push(this.getLineFromVoiceLines(this.getVoiceLinesFromSpeaker(e),t))}},{key:"update",value:function(){var e=this;if(!this.isPlaying){var t=this.soundQueue.shift();void 0!==t&&(this.isPlaying=!0,t.play(),t.onEndedObservable.addOnce(function(){e.isPlaying=!1}))}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}()},7212:function(e,t,n){n.d(t,{d:()=>tx}),n(22465),n(14199),n(90184);var r,a=n(48706),i=n(84835),o=n(71472),s=n(51971),u=n(60892),l=n(74842),c=n(64428),d=n(72392),f=n(87158),h=n(46060),v=n(80247),p=n(32133),m=n(9852),y=n(46526);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(){var e;function t(){if(!(this instanceof t))throw TypeError("Cannot call a class as a function")}return e=[{key:"write",value:function(e){return localStorage.setItem(t.SAVES_KEY,JSON.stringify(e)),!0}},{key:"read",value:function(e){var n=localStorage.getItem(t.SAVES_KEY),r=localStorage.getItem(t.BACKUP_SAVE_KEY);if(null===n&&null===r)return Promise.resolve((0,y.ok)({}));var a=(0,m.o)(null!=n?n:"{}");if(null===a)return Promise.resolve((0,y.c)({type:p.b.INVALID_JSON}));var i=(0,m.o)(null!=r?r:"{}");if(null===i)return Promise.resolve((0,y.c)({type:p.b.INVALID_JSON}));var o=v.oC.safeParse(a);if(!o.success)return console.error(o.error),Promise.resolve((0,y.c)({type:p.b.INVALID_STORAGE_FORMAT,content:o.error}));var s=v.oC.safeParse(i);if(!s.success)return console.error(s.error),Promise.resolve((0,y.c)({type:p.b.INVALID_STORAGE_FORMAT,content:s.error}));var u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){g(e,t,n[t])})}return e}({},o.data,s.data),l={},c={},d=!0,f=!1,h=void 0;try{for(var S,w=Object.entries(u)[Symbol.iterator]();!(d=(S=w.next()).done);d=!0){var E,P=(E=S.value,function(e){if(Array.isArray(e))return e}(E)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(E,2)||function(e,t){if(e){if("string"==typeof e)return b(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}}(E,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),C=P[0],T=P[1],A=(0,v.Vj)(T.manual,e),L=(0,v.Vj)(T.auto,e);l[C]={manual:A.validSaves,auto:L.validSaves},(A.invalidSaves.length>0||L.invalidSaves.length>0)&&(c[C]={manual:A.invalidSaves.map(function(e){return console.error("Corrupted manual save:",e.save,e.error),e.save}),auto:L.invalidSaves.map(function(e){return console.error("Corrupted auto save:",e.save,e.error),e.save})})}}catch(e){f=!0,h=e}finally{try{d||null==w.return||w.return()}finally{if(f)throw h}}return localStorage.setItem(t.BACKUP_SAVE_KEY,JSON.stringify(c)),Object.keys(c).length>0&&console.warn("Some save files could not be validated! Check the console for more information."),Promise.resolve((0,y.ok)(l))}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}}g(S,"SAVES_KEY","saves"),g(S,"BACKUP_SAVE_KEY","backupSaves");var A=function(){var e,t;function n(e,t){if(!(this instanceof n))throw TypeError("Cannot call a class as a function");C(this,"backend",void 0),C(this,"saves",void 0),this.backend=e,this.saves=t}return e=[{key:"getSavesForCmdr",value:function(e){return this.saves.get(e)}},{key:"save",value:function(){var e=Object.fromEntries(this.saves);return this.backend.write(e)}},{key:"renameCmdr",value:function(e,t){var n=this.saves.get(e);void 0!==n&&(n.manual.forEach(function(e){return e.player.name=t}),n.auto.forEach(function(e){return e.player.name=t}))}},{key:"deleteSaveForCmdr",value:function(e,t){var n=this.saves.get(e);if(void 0!==n){var r=n.manual.findIndex(function(e){return e===t});if(-1!==r)return void n.manual.splice(r,1);var a=n.auto.findIndex(function(e){return e===t});-1!==a&&n.auto.splice(a,1)}}},{key:"deleteCmdr",value:function(e){this.saves.delete(e)}},{key:"getCmdrUuids",value:function(){var e;return function(e){if(Array.isArray(e))return w(e)}(e=this.saves.keys())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},{key:"setCmdrSaves",value:function(e,t){this.saves.set(e,t)}}],t=[{key:"CreateAsync",value:function(e,t){var r;return(r=function(){var r,a,i,o,s,u,l,c,d,f;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(h){switch(h.label){case 0:return[4,e.read(t)];case 1:if(!(r=h.sent()).success)return[2,r];a=new Map,i=!0,o=!1,s=void 0;try{for(u=Object.entries(r.value)[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var v;v=l.value,d=(c=function(e){if(Array.isArray(e))return e}(v)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(v,2)||T(v,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],f=c[1],(0!==f.manual.length||0!==f.auto.length)&&a.set(d,f)}}catch(e){o=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}return[2,(0,y.ok)(new n(e,a))]}})},function(){var e=this,t=arguments;return new Promise(function(n,a){var i=r.apply(e,t);function o(e){E(i,n,a,o,s,"next",e)}function s(e){E(i,n,a,o,s,"throw",e)}o(void 0)})})()}}],e&&P(n.prototype,e),t&&P(n,t),n}(),L=n(96948),O=n(31872),I=n(50137),k=n(92099),M=n(73303);n(56605),n(10559);var R=n(79351);let V=n.p+"17af999e7b7ad57f.mp3",D=n.p+"041ff9a253ed825d.mp3",N=n.p+"1549759e283bd206.ogg",x=n.p+"31e17b20ef567c2c.ogg",_=n.p+"39989db1f505d453.ogg",B=n.p+"d0fafb23c7d554d6.mp3",j=n.p+"e681fd4fea79fa37.ogg",U=n.p+"2a8bc67628c05fba.ogg",G=n.p+"1814b3aace9cf589.ogg",F=n.p+"bf4b326c5ffca2bb.mp3",W=n.p+"368a319571c58001.ogg",Z=n.p+"c1c5397b26a6c809.ogg",z=n.p+"920dd9f7b92185e2.ogg";function Y(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function K(){var e;return e=function(e){var t,n,r,a,i,o,s,u,l,c,d,f,h,v,p,m,y;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(b){switch(b.label){case 0:return t=0,n=0,a=(r=function(r,a,i){var o=new Promise(function(e){var t=new R.$(r,a,null,function(){e(t)},i)});return n++,o.then(function(r){return e(++t,n,r.name),r})})("Wandering",V,{loop:!0}),i=r("StraussBlueDanube",Z),o=r("DeepRelaxation",N),s=r("AtlanteanTwilight",D),u=r("InfinitePerspective",j),l=r("ThatZenMoment",z),c=r("EchoesOfTime",x),d=r("PeaceOfMind",G),f=r("SpacialWinds",B),h=r("Mesmerize",U),v=r("Reawakening",F),p=r("EquatorialComplex",_),m=r("Soaring",W),y={},[4,a];case 1:return y.wandering=b.sent(),[4,i];case 2:return y.straussBlueDanube=b.sent(),[4,o];case 3:return y.deepRelaxation=b.sent(),[4,s];case 4:return y.atlanteanTwilight=b.sent(),[4,u];case 5:return y.infinitePerspective=b.sent(),[4,l];case 6:return y.thatZenMoment=b.sent(),[4,c];case 7:return y.echoesOfTime=b.sent(),[4,d];case 8:return y.peaceOfMind=b.sent(),[4,f];case 9:return y.spacialWinds=b.sent(),[4,h];case 10:return y.mesmerize=b.sent(),[4,v];case 11:return y.reawakening=b.sent(),[4,p];case 12:return y.equatorialComplex=b.sent(),[4,m];case 13:return[2,(y.soaring=b.sent(),y)]}})},(K=function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){Y(i,r,a,o,s,"next",e)}function s(e){Y(i,r,a,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}let H=n.p+"a77f60b1dade8fb8.mp3",X=n.p+"2344fdde5c5a6410.mp3",J=n.p+"a5a4982c205e1a77.mp3",q=n.p+"452710f264d2ba19.mp3",Q=n.p+"305475735c5d3c0e.mp3",$=n.p+"65ceacf6bbb524ce.mp3",ee=n.p+"5f6f5bf7bfca113e.mp3",et=n.p+"4884a61f606c46b6.mp3",en=n.p+"414af932bdf1a85c.mp3",er=n.p+"9bbc526876e8d7f3.mp3",ea=n.p+"4c543ebfed7579a0.mp3",ei=n.p+"dea0682c68132870.mp3";function eo(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function es(){var e;return e=function(e){var t,n,r,a,i,o,s,u,l,c,d,f,h,v,p,m,y,b,g;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(S){switch(S.label){case 0:return t=0,n=0,a=(r=function(r,a,i){var o=new Promise(function(e){var t=new R.$(r,a,null,function(){e(t)},i)});return n++,o.then(function(r){return e(++t,n,r.name),r})})("OuchSound",ei),i=r("EngineRunningSound",ea,{loop:!0}),o=r("MenuHoverSound",H,{playbackRate:.5}),s=r("MenuSelectSound",H),u=r("OpenPauseMenuSound",H,{playbackRate:.75}),l=r("TargetLockSound",er),c=r("TargetUnlockSound",er,{playbackRate:.5}),d=r("EnableWarpDriveSound",Q,{playbackRate:2}),f=r("DisableWarpDriveSound",X),h=r("AcceleratingWarpDriveSound",$,{playbackRate:1,volume:.3,loop:!0}),v=r("DeceleratingWarpDriveSound",et,{playbackRate:1,volume:.3,loop:!0}),p=r("HyperSpaceSound",ee,{playbackRate:1.5,volume:.25,loop:!0}),m=r("ThrusterSound",J,{playbackRate:1,volume:.5,loop:!0}),y=r("Success",en),b=r("Error",q),g={},[4,a];case 1:return g.ouch=S.sent(),[4,i];case 2:return g.engineRunning=S.sent(),[4,o];case 3:return g.menuHover=S.sent(),[4,s];case 4:return g.menuSelect=S.sent(),[4,u];case 5:return g.openPauseMenu=S.sent(),[4,l];case 6:return g.targetLock=S.sent(),[4,c];case 7:return g.targetUnlock=S.sent(),[4,d];case 8:return g.enableWarpDrive=S.sent(),[4,f];case 9:return g.disableWarpDrive=S.sent(),[4,h];case 10:return g.acceleratingWarpDrive=S.sent(),[4,v];case 11:return g.deceleratingWarpDrive=S.sent(),[4,p];case 12:return g.hyperSpace=S.sent(),[4,m];case 13:return g.thruster=S.sent(),[4,y];case 14:return g.success=S.sent(),[4,b];case 15:return[2,(g.error=S.sent(),g)]}})},(es=function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){eo(i,r,a,o,s,"next",e)}function s(e){eo(i,r,a,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}let eu=n.p+"d03a87f2075d6f53.mp3",el=n.p+"02b9b418f00b21c6.mp3",ec=n.p+"cd82c2ed886f9749.mp3",ed=n.p+"5d862e8381583459.mp3",ef=n.p+"c83251e2246e7d88.mp3",eh=n.p+"64c7906a8f900679.mp3",ev=n.p+"2da6813008740281.mp3",ep=n.p+"b3ce59bafdbe5a25.mp3",em=n.p+"cb1faa14ee3af51b.mp3",ey=n.p+"398d2c8156e90ba6.mp3",eb=n.p+"03f6eca0cfdf0539.mp3";function eg(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function eS(){var e;return e=function(e){var t,n,r,a,i,o,s,u,l,c,d,f,h,v,p,m;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(y){switch(y.label){case 0:return t=0,n=0,a=(r=function(r,a,i){var o=new Promise(function(e){var t=new R.$(r,a,null,function(){e(t)},i)});return n++,o.then(function(r){return e(++t,n,r.name),r})})("InitiatingPlanetaryLanding",ef),i=r("LandingRequestGranted",ev),o=r("LandingComplete",eh),s=r("MissionComplete",ep),u=r("NewDiscovery",em),l=r("CannotEngageWarpDrive",eu),c=r("WarpDriveEmergencyShutDown",eb),d=r("WarpDriveDisengaged",ey),f=r("EngagingWarpDrive",el),h=r("FuelScoopingVoice",ec),v=r("FuelScoopingCompleteVoice",ed),p={},m={},[4,a];case 1:return m.initiatingPlanetaryLanding=y.sent(),[4,i];case 2:return m.landingRequestGranted=y.sent(),[4,o];case 3:return m.landingComplete=y.sent(),[4,s];case 4:return m.missionComplete=y.sent(),[4,u];case 5:return m.newDiscovery=y.sent(),[4,l];case 6:return m.cannotEngageWarpDrive=y.sent(),[4,c];case 7:return m.warpDriveEmergencyShutDown=y.sent(),[4,d];case 8:return m.warpDriveDisengaged=y.sent(),[4,f];case 9:return m.engagingWarpDrive=y.sent(),[4,h];case 10:return m.fuelScooping=y.sent(),[4,v];case 11:return[2,(p.charlotte=(m.fuelScoopingComplete=y.sent(),m),p)]}})},(eS=function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){eg(i,r,a,o,s,"next",e)}function s(e){eg(i,r,a,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}function ew(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function eE(){var e;return e=function(e){var t,n,r,a;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(i){switch(i.label){case 0:return t=function(e){return es.apply(this,arguments)}(e),n=function(e){return K.apply(this,arguments)}(e),r=function(e){return eS.apply(this,arguments)}(e),a={},[4,t];case 1:return a.sounds=i.sent(),[4,n];case 2:return a.musics=i.sent(),[4,r];case 3:return[2,(a.speakerVoiceLines=i.sent(),a)]}})},(eE=function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){ew(i,r,a,o,s,"next",e)}function s(e){ew(i,r,a,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}var eP=n(15477);function eC(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function eT(){var e;return e=function(e,t){var n,r,a;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(i){switch(i.label){case 0:return n=function(e){return eE.apply(this,arguments)}(e),r=(0,eP.v)(e,t),a={},[4,n];case 1:return a.audio=i.sent(),[4,r];case 2:return[2,(a.rendering=i.sent(),a)]}})},(eT=function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){eC(i,r,a,o,s,"next",e)}function s(e){eC(i,r,a,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}var eA=n(72067),eL=n(37384);function eO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eI=function(){var e;function t(e,n){var r=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");eO(this,"currentMusic",null),eO(this,"silenceSeconds",0),eO(this,"volume",1),eO(this,"fadeSeconds",3),eO(this,"pauseMusicWhenPaused",!1),eO(this,"starSystemView",void 0),eO(this,"musics",void 0),this.musics=e,this.starSystemView=n;var a=eL.a.audioEngine;if(null===a)throw Error("Audio context is null");a.onAudioUnlockedObservable.add(function(){if(null!==r.currentMusic){var e=r.currentMusic;r.currentMusic=null,r.setMusic(e)}})}return e=[{key:"setMusicFromSelection",value:function(e){if(!(null!==this.currentMusic&&e.includes(this.currentMusic))){var t=e[Math.floor(Math.random()*e.length)];void 0!==t&&this.setMusic(t)}}},{key:"setMusic",value:function(e){if(this.currentMusic!==e){if(null!==this.currentMusic){this.currentMusic.setVolume(0,this.fadeSeconds),this.currentMusic.stop(this.fadeSeconds),this.currentMusic=null,this.silenceSeconds=this.fadeSeconds;return}null!==e&&(this.currentMusic=e,this.currentMusic.stop(),this.currentMusic.setVolume(0),this.currentMusic.play(),this.currentMusic.setVolume(this.volume,this.fadeSeconds),console.log("currently playing",this.currentMusic.name))}}},{key:"setSoundtrackVolume",value:function(e){this.volume=e,null!==this.currentMusic&&this.currentMusic.setVolume(e)}},{key:"update",value:function(e,t,n,r){if(null!==this.currentMusic){if(e&&this.pauseMusicWhenPaused&&this.currentMusic.isPlaying)return void this.currentMusic.pause();if(!e&&this.currentMusic.isPaused)return void this.currentMusic.play();e||this.currentMusic.isPlaying||(this.currentMusic=null,this.silenceSeconds=30+(Math.random()-.5)*20)}if(this.silenceSeconds>0){this.silenceSeconds-=r;return}if(!this.starSystemView.isLoadingSystem()){var a=this.starSystemView.getSpaceshipControls().getSpaceship(),i=this.starSystemView.scene.getActiveControls()===this.starSystemView.getCharacterControls(),o=this.starSystemView.scene.getActiveControls().getTransform().getAbsolutePosition(),u=this.starSystemView.getStarSystem().getNearestOrbitalObject(o),l=s.P.Distance(o,u.getTransform().getAbsolutePosition());if(!t||n)return void this.setMusic(this.musics.wandering);if(!a.isLanded()&&null!==a.getTargetLandingPad())return void this.setMusic(this.musics.straussBlueDanube);var c=a.getInternals().getWarpDrive();switch(u.model.type){case O.o.BLACK_HOLE:this.setMusicFromSelection([this.musics.soaring]);return;case O.o.MANDELBULB:case O.o.JULIA_SET:case O.o.MANDELBOX:case O.o.SIERPINSKI_PYRAMID:case O.o.MENGER_SPONGE:case O.o.DARK_KNIGHT:if(l<100*u.getBoundingRadius())return void this.setMusicFromSelection([this.musics.spacialWinds,this.musics.echoesOfTime]);break;case O.o.STAR:case O.o.NEUTRON_STAR:case O.o.TELLURIC_PLANET:case O.o.TELLURIC_SATELLITE:case O.o.GAS_PLANET:case O.o.CUSTOM:break;case O.o.SPACE_STATION:case O.o.SPACE_ELEVATOR:if((null===c||c.isDisabled())&&l<10*u.getBoundingRadius())return void this.setMusic(this.musics.equatorialComplex)}if(null!==c&&c.isEnabled()){var d=[this.musics.atlanteanTwilight,this.musics.infinitePerspective,this.musics.mesmerize];this.setMusicFromSelection(d);return}if(!a.isLanded()&&(null===c||c.isDisabled())){var f=[this.musics.thatZenMoment,this.musics.deepRelaxation,this.musics.peaceOfMind];this.setMusicFromSelection(f);return}if(i||a.isLanded()){var h=[this.musics.thatZenMoment,this.musics.deepRelaxation,this.musics.peaceOfMind,this.musics.mesmerize,this.musics.reawakening];this.setMusicFromSelection(h);return}this.setMusic(null)}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),ek=n(54530),eM=n(4761),eR=n(55914),eV=n(70620),eD=n(70618),eN=n(42328),ex=n(96775),e_=n(33778),eB=n(68215),ej=n(67791),eU=n(49541),eG=n(90328),eF=n(14280),eW=n(24660),eZ=n(32075),ez=n(15589);function eY(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function eK(){var e;return e=function(e,t){return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(n){return[2,new Promise(function(n){var r=new FileReader;r.onload=function(e){if(null===e.target)throw Error("event.target is null");var r,a=e.target.result;if(null===a)throw Error("data is null");if(null!=(r=ArrayBuffer)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](a):a instanceof r)throw Error("data is an ArrayBuffer");var i=(0,m.o)(a);if(null===i)return void n((0,y.c)({type:p.b.INVALID_JSON}));n((0,v.Yn)(i,t))},r.readAsText(e)})]})},(eK=function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){eY(i,r,a,o,s,"next",e)}function s(e){eY(i,r,a,o,s,"throw",e)}o(void 0)})}).apply(this,arguments)}var eH=n(67313);let eX=n.p+"84ce2b6784367db0.webp",eJ=n.p+"8a1c03268bf466ec.webp";var eq=n(73252);let eQ=n.p+"1a462202fcf3027a.webp",e$=n.p+"516b62e74a5c289b.webp",e0=n.p+"59c8c9e9e3e40806.webp",e1=n.p+"cffe491bb1a1152f.webp";function e2(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function e4(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){e2(i,r,a,o,s,"next",e)}function s(e){e2(i,r,a,o,s,"throw",e)}o(void 0)})}}function e3(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function e5(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var e6=function(){var e;function t(e,n){var r,a=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");var i=this;e3(this,"htmlRoot",void 0),e3(this,"cmdrList",void 0),e3(this,"onLoadSaveObservable",new ej.y$),e3(this,"soundPlayer",void 0),this.htmlRoot=document.createElement("div"),this.htmlRoot.classList.add("saveLoadingPanelContent"),this.soundPlayer=n;var o=document.createElement("div");o.id="dropFileZone",this.htmlRoot.appendChild(o);var s=document.createElement("p");s.innerText=eZ.Z.t("sidePanel:dropASaveFileHere"),o.appendChild(s),o.addEventListener("dragover",function(e){if(e.preventDefault(),e.stopPropagation(),o.classList.add("dragover"),o.classList.remove("invalid"),null===e.dataTransfer)throw Error("event.dataTransfer is null");e.dataTransfer.dropEffect="copy"}),o.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation(),o.classList.remove("dragover")}),o.addEventListener("drop",(r=e4(function(t){var n;return e5(this,function(r){switch(r.label){case 0:if(t.preventDefault(),t.stopPropagation(),o.classList.remove("dragover"),null===t.dataTransfer)throw Error("event.dataTransfer is null");if(0===t.dataTransfer.files.length)throw Error("event.dataTransfer.files is empty");if(void 0!==(n=t.dataTransfer.files[0]))return[3,2];return[4,(0,eB.UX)("No file dropped",i.soundPlayer)];case 1:case 3:return r.sent(),[2];case 2:return[4,i.loadSaveFile(n,e)]}})}),function(e){return r.apply(this,arguments)})),o.addEventListener("click",function(){a.soundPlayer.playNow(ek.k6.CLICK);var t=document.createElement("input");t.type="file",t.accept="application/json",t.onchange=e4(function(){var n;return e5(this,function(r){switch(r.label){case 0:if(null===t.files)throw Error("fileInput.files is null");if(0===t.files.length)throw Error("fileInput.files is empty");if(void 0!==(n=t.files[0]))return[3,2];return[4,(0,eB.UX)("No file selected",a.soundPlayer)];case 1:case 3:return r.sent(),[2];case 2:return[4,a.loadSaveFile(n,e)]}})}),t.click()}),this.cmdrList=document.createElement("div"),this.cmdrList.classList.add("cmdrList"),this.htmlRoot.appendChild(this.cmdrList)}return e=[{key:"populateCmdrList",value:function(e,t){var n=this;this.cmdrList.innerHTML="";var r=t.getCmdrUuids(),a=new Map,i=!0,o=!1,s=void 0;try{for(var u,l=r[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value,d=t.getSavesForCmdr(c);void 0!==d&&a.set(c,d.manual.concat(d.auto))}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}a.forEach(function(e){e.sort(function(e,t){return t.timestamp-e.timestamp})}),r.sort(function(e,t){var n,r,i=null==(n=a.get(e))?void 0:n.at(0),o=null==(r=a.get(t))?void 0:r.at(0);if(void 0===i||void 0===o)throw Error("aLatestSave or bLatestSave is undefined");return o.timestamp-i.timestamp}),r.forEach(function(r){var a=t.getSavesForCmdr(r);if(void 0!==a){var i=document.createElement("div");i.classList.add("cmdr"),n.cmdrList.appendChild(i);var o=a.auto.concat(a.manual);o.sort(function(e,t){return t.timestamp-e.timestamp});var s=o[0];if(void 0!==s){var u=document.createElement("div");u.classList.add("cmdrHeader"),i.appendChild(u);var l=document.createElement("div");l.classList.add("cmdrHeaderText"),u.appendChild(l);var c=document.createElement("h3");c.innerText=s.player.name,l.appendChild(c);var d=document.createElement("p");d.innerText=eZ.Z.t("sidePanel:lastPlayedOn",{val:new Date(s.timestamp),formatParams:{val:{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}}}),l.appendChild(d);var f=document.createElement("p");f.innerText=eZ.Z.t("sidePanel:journeyedFor",{nbHours:Math.ceil(s.player.timePlayedSeconds/60/60)}),l.appendChild(f);var h=document.createElement("div");h.classList.add("cmdrHeaderButtons"),u.appendChild(h);var p=document.createElement("button");p.classList.add("icon","large"),p.addEventListener("click",function(){n.soundPlayer.playNow(ek.k6.CLICK),n.onLoadSaveObservable.notifyObservers(s)}),h.appendChild(p);var m=document.createElement("img");m.src=e0,p.appendChild(m);var y=document.createElement("button");y.classList.add("icon","large"),y.addEventListener("click",e4(function(){var e;return e5(this,function(t){switch(t.label){case 0:if(n.soundPlayer.playNow(ek.k6.CLICK),null!==(e=(0,v.z0)(s)))return[3,2];return[4,(0,eB.UX)("Could not create a URL from the save file.",n.soundPlayer)];case 1:case 3:return t.sent(),[2];case 2:return[4,navigator.clipboard.writeText(e.toString()).then(function(){(0,eH.sc)(eH.OO.GENERAL,eH.sh.SUCCESS,eZ.Z.t("notifications:copiedToClipboard"),5e3,n.soundPlayer)})]}})})),h.appendChild(y);var b=document.createElement("img");b.src=e$,y.appendChild(b);var g=document.createElement("button");g.classList.add("icon","large"),g.addEventListener("click",e4(function(){var e;return e5(this,function(a){switch(a.label){case 0:return n.soundPlayer.playNow(ek.k6.CLICK),[4,(0,eB.We)(eZ.Z.t("sidePanel:cmdrNameChangePrompt"),s.player.name,n.soundPlayer)];case 1:if(null===(e=a.sent()))return[2];return t.renameCmdr(r,e),c.innerText=e,t.save(),[2]}})})),h.appendChild(g);var S=document.createElement("img");S.src=eq,g.appendChild(S);var w=document.createElement("div");w.classList.add("savesList"),w.classList.add("hidden"),i.appendChild(w),o.forEach(function(r){var i=n.createSaveDiv(r,a.auto.includes(r),e,t);w.appendChild(i)});var E=document.createElement("img");E.src=eQ;var P=document.createElement("img");P.src=eX;var C=document.createElement("button");C.classList.add("expandButton","icon","large"),C.appendChild(E),C.addEventListener("click",function(){n.soundPlayer.playNow(ek.k6.CLICK),w.classList.toggle("hidden"),C.innerHTML="",C.appendChild(w.classList.contains("hidden")?E:P)}),h.appendChild(C)}}})}},{key:"createSaveDiv",value:function(e,t,n,r){var a,i=this,o=document.createElement("div");o.classList.add("saveContainer");var s=document.createElement("div");s.classList.add("saveText"),o.appendChild(s);var u=document.createElement("p");u.innerText=(t?"[Auto] ":"")+new Date(e.timestamp).toLocaleString(),s.appendChild(u);var l=document.createElement("p"),c="inSpaceship"===e.playerLocation.type?e.shipLocations[e.playerLocation.shipId]:e.playerLocation;if(void 0===c)throw Error("locationToUse is undefined");if("inSpaceship"===c.type)throw Error("Spaceship inside a spaceship is not supported yet");var d="atStation"===c.type,f=n.getObjectModelByUniverseId(c.universeObjectId);l.innerText=eZ.Z.t(d?"sidePanel:landedAt":"sidePanel:near",{location:null!=(a=null==f?void 0:f.name)?a:eZ.Z.t("sidePanel:locationNotFound"),interpolation:{escapeValue:!1}}),s.appendChild(l);var h=document.createElement("div");h.classList.add("saveButtons"),o.appendChild(h);var p=document.createElement("button");p.classList.add("icon","large"),p.addEventListener("click",function(){i.soundPlayer.playNow(ek.k6.CLICK),i.onLoadSaveObservable.notifyObservers(e)}),h.appendChild(p);var m=document.createElement("img");m.src=e0,p.appendChild(m);var y=document.createElement("button");y.classList.add("icon","large");var b=this;y.addEventListener("click",e4(function(){var t;return e5(this,function(n){switch(n.label){case 0:if(b.soundPlayer.playNow(ek.k6.CLICK),null!==(t=(0,v.z0)(e)))return[3,2];return[4,(0,eB.UX)("Could not create a URL from the save file.",b.soundPlayer)];case 1:case 3:return n.sent(),[2];case 2:return[4,navigator.clipboard.writeText(t.toString()).then(function(){(0,eH.sc)(eH.OO.GENERAL,eH.sh.INFO,eZ.Z.t("notifications:copiedToClipboard"),5e3,b.soundPlayer)})]}})})),h.appendChild(y);var g=document.createElement("img");g.src=e$,y.appendChild(g);var S=document.createElement("button");S.classList.add("icon","large"),S.addEventListener("click",function(){i.soundPlayer.playNow(ek.k6.CLICK);var t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="".concat(e.player.name,"_").concat(e.timestamp,".json"),r.click(),URL.revokeObjectURL(n)}),h.appendChild(S);var w=document.createElement("img");w.src=eJ,S.appendChild(w);var E=document.createElement("button");E.classList.add("danger","icon","large");var P=this;E.addEventListener("click",e4(function(){var t,n,a;return e5(this,function(i){switch(i.label){case 0:return P.soundPlayer.playNow(ek.k6.CLICK),[4,(0,eB.bG)(eZ.Z.t("sidePanel:deleteSavePrompt"),P.soundPlayer)];case 1:if(!i.sent()||(r.deleteSaveForCmdr(e.player.uuid,e),void 0===(t=r.getSavesForCmdr(e.player.uuid))))return[2];return 0===t.auto.length&&0===t.manual.length&&(r.deleteCmdr(e.player.uuid),null==(a=o.parentElement)||null==(n=a.parentElement)||n.remove()),o.remove(),r.save(),[2]}})})),h.appendChild(E);var C=document.createElement("img");return C.src=e1,E.appendChild(C),o}},{key:"loadSaveFile",value:function(e,t){var n=this;return e4(function(){var r;return e5(this,function(a){switch(a.label){case 0:return[4,function(e,t){return eK.apply(this,arguments)}(e,t)];case 1:if((r=a.sent()).success)return[3,3];return console.error(r.error),[4,(0,eB.UX)((0,p.M)(r.error),n.soundPlayer)];case 2:return a.sent(),[2,r];case 3:return n.onLoadSaveObservable.notifyObservers(r.value),[2,r]}})})()}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),e7=n(43999),e8=n(2607),e9=n(58237),te=n(52653),tt=n(58672),tn=n(11508),tr=n(12428),ta=n(94117),ti=n(94997),to=[eR.S,ti.B,tr.v,tn.m,te.V,tt.H,ta.v],ts=n(30073),tu=n(91307);function tl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tc(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function td(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tl(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var tf=n(86950),th=n(24432),tv=n(16050),tp=n(31328);function tm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ty=function e(){var t=this;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");tm(this,"htmlRoot",void 0),tm(this,"onTutorialSelected",new ej.y$),tm(this,"availableTutorials",void 0),this.htmlRoot=document.createElement("div"),this.htmlRoot.classList.add("tutorialsMenuContainer"),this.availableTutorials=[new tf.d,new tp.b,new tv.D,new th.L],this.availableTutorials.forEach(function(e){var n=document.createElement("div");n.classList.add("tutorial");var r=document.createElement("h2");r.textContent=e.getTitle(),n.appendChild(r);var a=document.createElement("img");a.src=e.coverImageSrc,a.alt=e.getTitle(),n.appendChild(a);var i=document.createElement("p");i.textContent=e.getDescription(),n.appendChild(i),t.htmlRoot.appendChild(n),n.addEventListener("click",function(){t.onTutorialSelected.notifyObservers(e)})});var n=document.createElement("p");n.classList.add("moreWillCome"),n.textContent=eZ.Z.t("tutorials:common:moreWillComeSoon"),this.htmlRoot.appendChild(n)};function tb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tg=((r={})[r.LOAD_SAVE=0]="LOAD_SAVE",r[r.SETTINGS=1]="SETTINGS",r[r.TUTORIALS=2]="TUTORIALS",r[r.CONTRIBUTE=3]="CONTRIBUTE",r[r.CREDITS=4]="CREDITS",r[r.ABOUT=5]="ABOUT",r),tS=function(){var e;function t(e,n,r){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tb(this,"activeRightPanel",null),tb(this,"loadSavePanel",void 0),tb(this,"loadSavePanelContent",void 0),tb(this,"settingsPanel",void 0),tb(this,"tutorialsPanel",void 0),tb(this,"tutorialsPanelContent",void 0),tb(this,"contributePanel",void 0),tb(this,"creditsPanel",void 0),tb(this,"aboutPanel",void 0),tb(this,"starSystemDatabase",void 0),tb(this,"saveManager",void 0),this.starSystemDatabase=e,this.saveManager=n;var a=document.getElementById("loadSavePanel");if(null===a)throw Error("#loadSavePanel does not exist!");this.loadSavePanel=a,this.loadSavePanelContent=new e6(e,r),this.loadSavePanel.appendChild(this.loadSavePanelContent.htmlRoot),this.settingsPanel=function(){var e=document.getElementById("settingsPanel");if(null===e)throw Error("#settings does not exist!");return(0,ts.x)().then(function(t){to.forEach(function(n){var r=document.createElement("div");r.classList.add("map");var a=document.createElement("h3");a.textContent=n.name.replace(/([A-Z])/g," $1").trim(),r.appendChild(a);var i=!0,o=!1,s=void 0;try{for(var u,l=Object.entries(n.map)[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)!function(){var e=td(u.value,2),n=e[0],a=e[1],i=new Map;(tc(a,e7.Z)?a.bindings:a.action.bindings).forEach(function(e){if(tc(e.control,e9.Z))(0,tu.cs)(e.control,t).forEach(function(e){var t,n=td(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(tc(e.control,e8.N3)){var n,r=(0,tu.x_)(e.control,t);i.has("BUTTON")||i.set("BUTTON",[]),null==(n=i.get("BUTTON"))||n.push(r)}else if(tc(e.control,e8.LV))(0,tu.C9)(e.control,t).forEach(function(e){var t,n=td(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(tc(e.control,e8.Z9))(0,tu.JT)(e.control).forEach(function(e){var t,n=td(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(tc(e.control,e8.xE))(0,tu.gG)().forEach(function(e){var t,n=td(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else throw Error("Unknown control type")});var o=document.createElement("div"),s=document.createElement("p");if(s.textContent=n.replace(/([A-Z])/g," $1").trim(),o.appendChild(s),1===i.size){o.classList.add("actionSingle");var l=document.createElement("div");l.classList.add("valuesContainer");var c=!0,d=!1,f=void 0;try{for(var h,v=i.values()[Symbol.iterator]();!(c=(h=v.next()).done);c=!0)h.value.forEach(function(e){var t=document.createElement("p");t.innerText=e,l.appendChild(t)})}catch(e){d=!0,f=e}finally{try{c||null==v.return||v.return()}finally{if(d)throw f}}o.appendChild(l)}else o.classList.add("actionMultiple"),i.forEach(function(e,t){var n=document.createElement("div");n.classList.add("subAction");var r=document.createElement("p");r.textContent=t;var a=document.createElement("div");a.classList.add("valuesContainer"),e.forEach(function(e){var t=document.createElement("p");t.innerText=e,a.appendChild(t)}),n.appendChild(r),n.appendChild(a),o.appendChild(n)});r.appendChild(o)}()}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}e.appendChild(r)})}),e}();var i=document.getElementById("tutorials");if(null===i)throw Error("#tutorials does not exist!");this.tutorialsPanel=i,this.tutorialsPanelContent=new ty,this.tutorialsPanel.appendChild(this.tutorialsPanelContent.htmlRoot);var o=document.getElementById("contribute");if(null===o)throw Error("#contribute does not exist!");this.contributePanel=o;var s=document.getElementById("credits");if(null===s)throw Error("#credits does not exist!");this.creditsPanel=s;var u=document.getElementById("about");if(null===u)throw Error("#about does not exist!");this.aboutPanel=u}return e=[{key:"panelFromType",value:function(e){var t=null;switch(e){case 0:t=this.loadSavePanel;break;case 1:t=this.settingsPanel;break;case 2:t=this.tutorialsPanel;break;case 3:t=this.contributePanel;break;case 4:t=this.creditsPanel;break;case 5:t=this.aboutPanel}return t}},{key:"toggleActivePanel",value:function(e){var t=this.panelFromType(e);if(this.activeRightPanel===t)return void this.hideActivePanel();0===e&&this.loadSavePanelContent.populateCmdrList(this.starSystemDatabase,this.saveManager),null!==this.activeRightPanel&&this.hideActivePanel(),this.activeRightPanel=t,t.classList.add("visible")}},{key:"hideActivePanel",value:function(){null!==this.activeRightPanel&&(this.activeRightPanel.classList.remove("visible"),this.activeRightPanel=null)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function tw(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tE(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){tw(i,r,a,o,s,"next",e)}function s(e){tw(i,r,a,o,s,"throw",e)}o(void 0)})}}function tP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tC(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var tT=function(){var e;function t(e,n,r,a){var i=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tP(this,"scene",void 0),tP(this,"controls",void 0),tP(this,"starSystemView",void 0),tP(this,"starSystemModel",void 0),tP(this,"onStartObservable",new ej.y$),tP(this,"onContributeObservable",new ej.y$),tP(this,"onCreditsObservable",new ej.y$),tP(this,"onAboutObservable",new ej.y$),tP(this,"htmlRoot",void 0),tP(this,"title",void 0),tP(this,"version",void 0),tP(this,"sidePanels",void 0),tP(this,"universeObjectId",void 0),tP(this,"startAnimationDurationSeconds",5),this.sidePanels=e,this.starSystemView=n,this.scene=this.starSystemView.scene,this.controls=this.starSystemView.getDefaultControls(),this.starSystemView.setUIEnabled(!1);var o=r.getSystemModelFromCoordinates({localX:.49137314641446483,localY:.48043087077347135,localZ:.38353311777279386,starSectorX:0,starSectorY:0,starSectorZ:0});if(null===o)throw Error("Cannot find system");var s=o.planets.at(1);if(void 0===s)throw Error("Cannot find planet with index 2");this.universeObjectId=(0,M.D2)(s,o),this.starSystemModel=o;var u=document.getElementById("mainMenu");if(null===u)throw Error("#mainMenu does not exist!");this.htmlRoot=u,this.htmlRoot.style.display="none";var l=document.querySelector("#mainMenu h1");if(null===l)throw Error("#mainMenu h1 does not exist!");this.title=l;var c=document.getElementById("version");if(null===c)throw Error("#version does not exist!");var d=c.querySelector("a");if(null===d)throw Error("version link does not exist!");d.textContent="Alpha ".concat(ez.i8),this.version=c,document.querySelectorAll("#menuItems li").forEach(function(e){e.addEventListener("mouseenter",function(){a.playNow(ek.k6.HOVER)}),e.addEventListener("click",function(){a.playNow(ek.k6.CLICK)})}),document.querySelectorAll("#mainMenu *[data-i18n]").forEach(function(e){var t=e.getAttribute("data-i18n");if(null===t)throw Error("data-i18n attribute is null");e.textContent=eZ.Z.t(t)});var f=document.getElementById("startButton");if(null===f)throw Error("#startButton does not exist!");f.addEventListener("click",function(){i.startAnimation(function(){return i.onStartObservable.notifyObservers()})});var h=document.getElementById("loadSaveButton");if(null===h)throw Error("#loadSaveButton does not exist!");h.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tg.LOAD_SAVE)}),this.sidePanels.loadSavePanelContent.onLoadSaveObservable.add(function(){i.hide()});var v=document.getElementById("settingsButton");if(null===v)throw Error("#settingsButton does not exist!");v.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tg.SETTINGS)});var p=document.getElementById("tutorialsButton");if(null===p)throw Error("#tutorialsButton does not exist!");p.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tg.TUTORIALS)});var m=document.getElementById("contributeButton");if(null===m)throw Error("#contributeButton does not exist!");m.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tg.CONTRIBUTE),i.onContributeObservable.notifyObservers()});var y=document.getElementById("creditsButton");if(null===y)throw Error("#creditsButton does not exist!");y.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tg.CREDITS),i.onCreditsObservable.notifyObservers()});var b=document.getElementById("aboutButton");if(null===b)throw Error("#aboutButton does not exist!");b.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tg.ABOUT),i.onAboutObservable.notifyObservers()})}return e=[{key:"init",value:function(){var e=this;return tE(function(){return tC(this,function(t){switch(t.label){case 0:return[4,e.starSystemView.loadStarSystem(e.starSystemModel)];case 1:return t.sent(),e.starSystemView.onInitStarSystem.addOnce(tE(function(){var t,n;return tC(this,function(r){switch(r.label){case 0:return[4,e.starSystemView.switchToDefaultControls(!1)];case 1:if(r.sent(),t=e.starSystemModel.stellarObjects[0].type===O.o.BLACK_HOLE?8:2,void 0===(n=e.starSystemView.getStarSystem().getOrbitalObjectById(e.universeObjectId.idInSystem)))throw Error("Could not find object with ID ".concat(JSON.stringify(e.universeObjectId)));return(0,eW.xM)(e.controls,n,e.starSystemView.getStarSystem(),t),[2]}})})),e.starSystemView.targetCursorLayer.setEnabled(!1),e.htmlRoot.style.display="block",[2]}})})()}},{key:"startAnimation",value:function(e){var t=this;this.sidePanels.hideActivePanel();var n=this.starSystemView.getStarSystem(),r=(0,eF.cs)(this.controls.getTransform()),a=n.getOrbitalObjectById(this.universeObjectId.idInSystem),i=n.getCelestialBodies().find(function(e){return e===a});if(void 0===i)throw Error("No corresponding celestial body found");var o=i.getTransform().getAbsolutePosition().subtract(this.controls.getTransform().getAbsolutePosition()).normalize(),u=s.P.Cross(r,o),l=s.P.GetAngleBetweenVectors(r,o,u),c=(0,eW._T)(i,n,.9),d=new eU._(this.controls.getTransform(),u,l,this.startAnimationDurationSeconds),f=new eG.J(this.controls.getTransform(),c,this.startAnimationDurationSeconds);this.title.animate([{marginTop:this.title.style.marginTop,opacity:1},{marginTop:"30vh",opacity:0}],{duration:1e3*this.startAnimationDurationSeconds,easing:"ease-in-out",fill:"forwards"});var h=function(){var r=t.scene.getEngine().getDeltaTime()/1e3;if(f.isFinished()||f.update(r),d.isFinished()){t.scene.onBeforePhysicsObservable.removeCallback(h),t.htmlRoot.style.display="none",t.starSystemView.setUIEnabled(!0),e();return}d.update(r),t.controls.getActiveCamera().getViewMatrix(),n.applyFloatingOrigin(),n.updateShaders(0,t.starSystemView.postProcessManager)};this.scene.onBeforePhysicsObservable.add(h),this.hideMenu(),this.hideVersion()}},{key:"hideVersion",value:function(){this.version.style.transform="translateY(100%)"}},{key:"hideMenu",value:function(){var e=document.getElementById("menuItems");if(null===e)throw Error("#menuItems does not exist!");e.style.left="-20%"}},{key:"hide",value:function(){this.hideVersion(),this.hideMenu(),this.sidePanels.hideActivePanel(),this.htmlRoot.style.display="none"}},{key:"isVisible",value:function(){return"none"!==this.htmlRoot.style.display}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function tA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tL=function(){var e;function t(e,n){var r=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tA(this,"rootNode",void 0),tA(this,"mask",void 0),tA(this,"screenshotButton",void 0),tA(this,"shareButton",void 0),tA(this,"contributeButton",void 0),tA(this,"tutorialsButton",void 0),tA(this,"settingsButton",void 0),tA(this,"loadButton",void 0),tA(this,"saveButton",void 0),tA(this,"resumeButton",void 0),tA(this,"sidePanels",void 0),tA(this,"onScreenshot",new ej.y$),tA(this,"onShare",new ej.y$),tA(this,"onSave",new ej.y$),tA(this,"onResume",new ej.y$),this.sidePanels=e,this.rootNode=document.getElementById("pauseMenu"),this.mask=document.getElementById("pauseMask"),this.screenshotButton=document.getElementById("screenshotButton"),this.screenshotButton.addEventListener("click",function(){return r.onScreenshot.notifyObservers()}),this.shareButton=document.getElementById("shareButton"),this.shareButton.addEventListener("click",function(){return r.onShare.notifyObservers()}),this.contributeButton=document.getElementById("pauseContributeButton"),this.contributeButton.addEventListener("click",function(){n.playNow(ek.k6.CLICK),r.sidePanels.toggleActivePanel(tg.CONTRIBUTE)}),this.tutorialsButton=document.getElementById("pauseTutorialsButton"),this.tutorialsButton.addEventListener("click",function(){n.playNow(ek.k6.CLICK),r.sidePanels.toggleActivePanel(tg.TUTORIALS)}),this.settingsButton=document.getElementById("pauseSettingsButton"),this.settingsButton.addEventListener("click",function(){n.playNow(ek.k6.CLICK),r.sidePanels.toggleActivePanel(tg.SETTINGS)}),this.loadButton=document.getElementById("loadButton"),this.loadButton.addEventListener("click",function(){n.playNow(ek.k6.CLICK),r.sidePanels.toggleActivePanel(tg.LOAD_SAVE)}),this.saveButton=document.getElementById("saveButton"),this.saveButton.addEventListener("click",function(){return r.onSave.notifyObservers()}),this.resumeButton=document.getElementById("resumeButton"),this.resumeButton.addEventListener("click",function(){return r.onResume.notifyObservers()}),document.querySelectorAll("#pauseMenu li").forEach(function(e){e.addEventListener("mouseenter",function(){n.playNow(ek.k6.HOVER)}),e.addEventListener("click",function(){n.playNow(ek.k6.CLICK)})}),this.setVisibility(!1)}return e=[{key:"setVisibility",value:function(e){this.rootNode.style.display=e?"grid":"none",this.mask.style.display=e?"block":"none",e||this.sidePanels.hideActivePanel()}},{key:"isVisible",value:function(){return"none"!==this.rootNode.style.visibility}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),tO=n(19577),tI=n(91822),tk=n(76473);function tM(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tR(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){tM(i,r,a,o,s,"next",e)}function s(e){tM(i,r,a,o,s,"throw",e)}o(void 0)})}}function tV(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tN(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var tx=function(){var e,t;function r(e,t,n,a,i,o,u,l,c){var d,f,h,p=this;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");var m=this;tD(this,"engine",void 0),tD(this,"assets",void 0),tD(this,"starSystemView",void 0),tD(this,"starMap",void 0),tD(this,"musicConductor",void 0),tD(this,"soundPlayer",void 0),tD(this,"tts",void 0),tD(this,"mainMenu",void 0),tD(this,"pauseMenu",void 0),tD(this,"sidePanels",void 0),tD(this,"tutorialLayer",void 0),tD(this,"activeView",void 0),tD(this,"state",0),tD(this,"videoRecorder",null),tD(this,"player",void 0),tD(this,"encyclopaedia",void 0),tD(this,"starSystemDatabase",void 0),tD(this,"saveManager",void 0),tD(this,"elapsedSeconds",0),tD(this,"autoSavePeriodSeconds",300),tD(this,"autoSaveTimerSeconds",0),tD(this,"isAutoSaveEnabled",!0),this.engine=t,this.assets=n,this.player=e,this.player.onNameChangedObservable.add(function(e){p.saveManager.renameCmdr(p.player.uuid,e),p.saveManager.save()}),this.starSystemDatabase=o,this.saveManager=u,this.encyclopaedia=i,this.player.discoveries.uploaded.forEach((d=tR(function(e){return tN(this,function(t){switch(t.label){case 0:return[4,m.encyclopaedia.contributeDiscoveryIfNew(e)];case 1:return t.sent(),[2]}})}),function(e){return d.apply(this,arguments)})),this.starSystemView=a,this.starSystemView.onBeforeJump.add(function(){p.createAutoSave()}),this.starSystemView.onAfterJump.add(tR(function(){return tN(this,function(e){switch(e.label){case 0:if(m.createAutoSave(),m.player.tutorials.fuelScoopingCompleted)return[3,2];return[4,m.tutorialLayer.setTutorial(new th.L)];case 1:e.sent(),m.tutorialLayer.onQuitTutorial.addOnce(function(){m.player.tutorials.fuelScoopingCompleted=!0}),e.label=2;case 2:return[2]}})})),this.starSystemView.onNewDiscovery.add(function(){p.createAutoSave()}),this.musicConductor=new eI(this.assets.audio.musics,this.starSystemView),this.soundPlayer=l,this.tts=c,this.starMap=new eD.s(this.player,this.engine,this.encyclopaedia,this.starSystemDatabase,this.soundPlayer),this.starMap.onTargetSetObservable.add(function(e){p.starSystemView.setSystemAsTarget(e)}),this.starMap.detachControl(),this.starSystemView.attachControl(),this.activeView=this.starSystemView,l.setInstanceMask(eA.S.STAR_SYSTEM_VIEW),this.tutorialLayer=new tO.b(this.soundPlayer),document.body.appendChild(this.tutorialLayer.root),this.sidePanels=new tS(this.starSystemDatabase,this.saveManager,this.soundPlayer),this.sidePanels.loadSavePanelContent.onLoadSaveObservable.add(function(e){t.onEndFrameObservable.addOnce(tR(function(){return tN(this,function(t){switch(t.label){case 0:return p.isPaused()&&p.createAutoSave(),[4,p.resume()];case 1:return t.sent(),p.starSystemView.setUIEnabled(!0),[4,p.loadSave(e)];case 2:return t.sent(),[2]}})}))}),this.mainMenu=new tT(this.sidePanels,this.starSystemView,this.starSystemDatabase,this.soundPlayer),this.mainMenu.onStartObservable.add(tR(function(){var e,t;return tN(this,function(n){switch(n.label){case 0:return[4,m.tutorialLayer.setTutorial(new tf.d)];case 1:return n.sent(),m.tutorialLayer.onQuitTutorial.addOnce(function(){m.player.tutorials.flightCompleted=!0}),[4,m.starSystemView.switchToSpaceshipControls()];case 2:return n.sent(),e=m.starSystemView.getSpaceshipControls().getTransform().getAbsolutePosition(),t=m.starSystemView.getStarSystem().getOrbitalFacilities().reduce(function(t,n){return s.P.DistanceSquared(e,n.getTransform().getAbsolutePosition())<s.P.DistanceSquared(e,t.getTransform().getAbsolutePosition())?n:t}),m.starSystemView.setTarget(t),m.createAutoSave(),[2]}})})),this.sidePanels.tutorialsPanelContent.onTutorialSelected.add((f=tR(function(e){return tN(this,function(t){switch(t.label){case 0:if(m.mainMenu.isVisible())return[3,2];return m.createAutoSave(),[4,(0,eB.bG)(eZ.Z.t("tutorials:common:loadTutorialWillLeaveGame"),m.soundPlayer)];case 1:if(!t.sent())return[2];t.label=2;case 2:return m.sidePanels.hideActivePanel(),m.loadTutorial(e),[2]}})}),function(e){return f.apply(this,arguments)})),this.starSystemView.getSpaceshipControls().onToggleWarpDrive.add((h=tR(function(e){var t,n,r,a,i;return tN(this,function(o){switch(o.label){case 0:if(e||m.player.tutorials.stationLandingCompleted||null===(n=(t=m.starSystemView.getSpaceshipControls()).getClosestLandableFacility())||(r=t.getTransform().getAbsolutePosition(),a=n.getTransform().position,i=10*n.getBoundingRadius(),s.P.DistanceSquared(r,a)>Math.pow(i,2)))return[2];return[4,m.tutorialLayer.setTutorial(new tp.b)];case 1:return o.sent(),m.tutorialLayer.onQuitTutorial.addOnce(function(){m.player.tutorials.stationLandingCompleted=!0}),[2]}})}),function(e){return h.apply(this,arguments)})),this.starSystemView.getSpaceshipControls().onCompleteLanding.add(function(){p.createAutoSave()}),this.starSystemView.onInitStarSystem.add(function(){var e=p.starSystemView.getStarSystem().model;p.starMap.setCurrentStarSystem(e.coordinates)}),this.starSystemView.spaceStationLayer.onTakeOffObservable.add(tR(function(){return tN(this,function(e){switch(e.label){case 0:if(m.player.tutorials.starMapCompleted)return[2];return[4,m.tutorialLayer.setTutorial(new tv.D)];case 1:return e.sent(),m.tutorialLayer.onQuitTutorial.addOnce(function(){m.player.tutorials.starMapCompleted=!0}),[2]}})})),this.pauseMenu=new tL(this.sidePanels,this.soundPlayer),this.pauseMenu.onResume.add(function(){return p.resume()}),this.pauseMenu.onScreenshot.add(function(){return p.takeScreenshot()}),this.pauseMenu.onShare.add(function(){p.engine.onEndFrameObservable.addOnce(tR(function(){var e,t;return tN(this,function(n){switch(n.label){case 0:if((e=p.generateSaveData()).player.uuid=tk.Z.SHARED_POSITION_SAVE_UUID,null!==(t=(0,v.z0)(e)))return[3,2];return[4,(0,eB.UX)("Could not create a shareable link.",p.soundPlayer)];case 1:case 3:return n.sent(),[2];case 2:return[4,navigator.clipboard.writeText(t.toString()).then(function(){(0,eH.sc)(eH.OO.GENERAL,eH.sh.INFO,eZ.Z.t("notifications:copiedToClipboard"),2e3,p.soundPlayer)})]}})}))}),this.pauseMenu.onSave.add(tR(function(){return tN(this,function(e){switch(e.label){case 0:return[4,m.saveToLocalStorage()];case 1:return e.sent()?(0,eH.sc)(eH.OO.GENERAL,eH.sh.SUCCESS,eZ.Z.t("notifications:saveOk"),2e3,m.soundPlayer):(0,eH.sc)(eH.OO.GENERAL,eH.sh.ERROR,eZ.Z.t("notifications:cantSaveTutorial"),2e3,m.soundPlayer),[2]}})})),window.addEventListener("blur",function(){p.mainMenu.isVisible()||p.starSystemView.isLoadingSystem()||p.pause()}),window.addEventListener("mouseleave",function(){p.mainMenu.isVisible()||p.starSystemView.isLoadingSystem()||p.pause()}),window.addEventListener("resize",function(){p.engine.resize(!0)}),window.addEventListener("beforeunload",function(){p.mainMenu.isVisible()||p.createAutoSave()}),eR.S.map.toggleStarMap.on("complete",tR(function(){return tN(this,function(e){switch(e.label){case 0:if(m.mainMenu.isVisible())return[2];return[4,m.toggleStarMap()];case 1:return e.sent(),[2]}})})),eR.S.map.screenshot.on("complete",tR(function(){return tN(this,function(e){switch(e.label){case 0:if(m.mainMenu.isVisible())return[2];return[4,m.takeScreenshot()];case 1:return e.sent(),[2]}})})),eR.S.map.videoCapture.on("complete",tR(function(){return tN(this,function(e){switch(e.label){case 0:if(m.mainMenu.isVisible())return[2];return[4,m.takeVideoCapture()];case 1:return e.sent(),[2]}})})),eR.S.map.togglePause.on("complete",function(){!p.mainMenu.isVisible()&&(p.isPaused()||p.pause())}),window.CosmosJourneyer=this}return e=[{key:"pause",value:function(){!this.isPaused()&&(this.mainMenu.isVisible()||(this.state=2,document.exitPointerLock(),this.activeView===this.starSystemView&&this.starSystemView.stopBackgroundSounds(),this.soundPlayer.playNow(ek.k6.OPEN_PAUSE_MENU),this.pauseMenu.setVisibility(!0)))}},{key:"resume",value:function(){var e=this;return tR(function(){var t;return tN(this,function(n){switch(n.label){case 0:if(!e.isPaused())return[2];if(e.state=1,e.soundPlayer.playNow(ek.k6.CLICK),e.pauseMenu.setVisibility(!1),!(e.activeView===e.starSystemView&&e.starSystemView.scene.getActiveControls().shouldLockPointer()))return[3,2];return[4,null==(t=e.engine.getRenderingCanvas())?void 0:t.requestPointerLock()];case 1:n.sent(),n.label=2;case 2:return[2]}})})()}},{key:"isPaused",value:function(){return 2===this.state}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return tR(function(){return tN(this,function(n){switch(n.label){case 0:if(e)return[3,2];return[4,t.mainMenu.init()];case 1:n.sent(),n.label=2;case 2:return t.starSystemView.initStarSystem(),t.engine.runRenderLoop(function(){var e=t.engine.getDeltaTime()/1e3;t.elapsedSeconds+=e,t.player.timePlayedSeconds+=e,t.engine.loadingScreen.setProgressPercentage(100*t.starSystemView.loader.getLoadingProgress()),t.autoSaveTimerSeconds+=e,t.autoSaveTimerSeconds>=t.autoSavePeriodSeconds&&(t.autoSaveTimerSeconds%=t.autoSavePeriodSeconds,t.mainMenu.isVisible()||t.starSystemView.isJumpingBetweenSystems()||t.createAutoSave()),(0,eH.BX)(e),t.musicConductor.update(t.isPaused(),t.activeView===t.starSystemView,t.mainMenu.isVisible(),e),t.soundPlayer.update(),t.tts.update(),t.isPaused()||t.activeView.render()}),t.state=1,[2]}})})()}},{key:"toggleStarMap",value:function(){var e=this;return tR(function(){var t,n;return tN(this,function(r){switch(r.label){case 0:if(e.activeView!==e.starSystemView)return[3,1];return e.soundPlayer.setInstanceMask(eA.S.STAR_MAP_VIEW),e.starSystemView.targetCursorLayer.setEnabled(!1),document.exitPointerLock(),e.starSystemView.detachControl(),e.starMap.attachControl(),t=e.starMap,e.activeView=t,t.focusOnCurrentSystem(),[3,3];case 1:if(e.starMap.detachControl(),e.starSystemView.attachControl(),e.soundPlayer.setInstanceMask(eA.S.STAR_SYSTEM_VIEW),e.activeView=e.starSystemView,!e.starSystemView.scene.getActiveControls().shouldLockPointer())return[3,3];return[4,null==(n=e.engine.getRenderingCanvas())?void 0:n.requestPointerLock()];case 2:r.sent(),r.label=3;case 3:return[2]}})})()}},{key:"takeScreenshot",value:function(){var e=this;return tR(function(){var t;return tN(this,function(n){switch(n.label){case 0:if(null!==(t=e.activeView.getMainScene().activeCamera))return[3,2];return[4,(0,eB.UX)("Cannot take screenshot: camera is null",e.soundPlayer)];case 1:return n.sent(),[2,!1];case 2:return u.w1.CreateScreenshot(e.engine,t,{precision:1}),[2,!0]}})})()}},{key:"takeVideoCapture",value:function(){var e=this;return tR(function(){return tN(this,function(t){switch(t.label){case 0:if(!l.S.IsSupported(e.engine))return console.warn("Your browser does not support video recording!"),[2];if(null===e.videoRecorder&&(e.videoRecorder=new l.S(e.engine,{fps:60,recordChunckSize:3e6,mimeType:"video/webm;codecs=h264"})),!e.videoRecorder.isRecording)return[3,1];return e.videoRecorder.stopRecording(),[3,3];case 1:return[4,e.videoRecorder.startRecording("planetEngine.webm",Number(prompt("Enter video duration in seconds","10"))).then()];case 2:t.sent(),t.label=3;case 3:return[2]}})})()}},{key:"getCurrentUniverseCoordinates",value:function(e){var t=this.starSystemView.getStarSystem(),n=e.getAbsolutePosition(),r=t.getNearestOrbitalObject(n),a=(0,M.D2)(r.model,t.model),i=r.getTransform().computeWorldMatrix(!0).clone().invert(),o=s.P.TransformCoordinates(n,i);o.length()<1.1*r.getBoundingRadius()&&o.copyFromFloats(0,0,5*r.getBoundingRadius());var u=e.absoluteRotationQuaternion,l=r.getTransform().absoluteRotationQuaternion.clone().invert(),c=u.multiply(l);return{type:"relative",universeObjectId:a,position:{x:o.x,y:o.y,z:o.z},rotation:{x:c.x,y:c.y,z:c.z,w:c.w}}}},{key:"generateSaveData",value:function(){var e=this.starSystemView.getSpaceshipControls(),t=e.getSpaceship(),n=this.getCurrentUniverseCoordinates(e.getTransform()),r=t.isLandedAtFacility()?{type:"atStation",universeObjectId:n.universeObjectId}:n;return{timestamp:Date.now(),player:eV.J.Serialize(this.player),playerLocation:{type:"inSpaceship",shipId:t.id},shipLocations:tD({},t.id,r)}}},{key:"saveToLocalStorage",value:function(){var e=this;return tR(function(){var t,n,r,a,i,o,s;return tN(this,function(u){switch(u.label){case 0:if(e.player.uuid===tk.Z.TUTORIAL_SAVE_UUID)return[2,!1];if(e.player.uuid!==tk.Z.SHARED_POSITION_SAVE_UUID)return[3,2];return e.player.uuid=crypto.randomUUID(),r=(n=e.player).setName,[4,(0,eB.We)(eZ.Z.t("spaceStation:cmdrNameChangePrompt"),e.player.getName(),e.soundPlayer)];case 1:r.apply(n,[null!=(t=u.sent())?t:"Python"]),u.label=2;case 2:return i=(a=e.generateSaveData()).player.uuid,(s=null!=(o=e.saveManager.getSavesForCmdr(i))?o:{manual:[],auto:[]}).manual.unshift(a),e.saveManager.setCmdrSaves(i,s),[2,e.saveManager.save()]}})})()}},{key:"setAutoSaveEnabled",value:function(e){this.isAutoSaveEnabled=e}},{key:"createAutoSave",value:function(){if(this.isAutoSaveEnabled){var e,t=this.generateSaveData(),n=t.player.uuid;if(n!==tk.Z.SHARED_POSITION_SAVE_UUID&&n!==tk.Z.TUTORIAL_SAVE_UUID){var r=null!=(e=this.saveManager.getSavesForCmdr(n))?e:{manual:[],auto:[t]};for(r.auto.unshift(t);r.auto.length>tk.Z.MAX_AUTO_SAVES;)r.auto.pop();this.saveManager.setCmdrSaves(n,r),this.saveManager.save(),this.autoSaveTimerSeconds=0}}}},{key:"downloadSaveFile",value:function(){var e=this;this.engine.onEndFrameObservable.addOnce(function(){var t=new Blob([JSON.stringify(e.generateSaveData())],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n;var a=new Date().toLocaleString().replace(/[^0-9a-zA-Z]/g,"_");r.download="CMDR_".concat(e.player.getName(),"_").concat(a,".json"),r.click()})}},{key:"loadTutorial",value:function(e){var t=this;this.engine.onEndFrameObservable.addOnce(tR(function(){var n,r;return tN(this,function(a){switch(a.label){case 0:if(t.mainMenu.hide(),(n=e.getSaveData(t.starSystemDatabase)).success)return[3,2];return console.error(n.error),[4,(0,eB.UX)(eZ.Z.t("The tutorial save has errors and could not be loaded! Check the console for more information."),t.soundPlayer)];case 1:return a.sent(),[2];case 2:return[4,t.loadSave(n.value)];case 3:return a.sent(),t.player.uuid=tk.Z.TUTORIAL_SAVE_UUID,[4,t.resume()];case 4:return a.sent(),[4,t.tutorialLayer.setTutorial(e)];case 5:return a.sent(),t.starSystemView.setUIEnabled(!0),r=t.starSystemView.getStarSystem().getNearestOrbitalObject(t.starSystemView.scene.getActiveControls().getTransform().getAbsolutePosition()),t.starSystemView.getSpaceshipControls().getTransform().lookAt(r.getTransform().getAbsolutePosition()),[2]}})}))}},{key:"loadSave",value:function(e){var t=this;return tR(function(){var n,r,a,i,o;return tN(this,function(s){switch(s.label){case 0:if("inSpaceship"===(n=e.playerLocation).type)return[3,1];return r=n,[3,6];case 1:if(void 0!==(a=e.shipLocations[n.shipId]))return[3,3];return[4,(0,eB.UX)("Player is in spaceship, but said spaceship does not exist. The loading procedure has been aborted.",t.soundPlayer)];case 2:case 4:return s.sent(),[2];case 3:if("inSpaceship"!==a.type)return[3,5];return[4,(0,eB.UX)("Spaceship inside spaceships is not yet supported. The loading procedure has been aborted.",t.soundPlayer)];case 5:r=a,s.label=6;case 6:if(null!==(i=t.starSystemDatabase.getSystemModelFromCoordinates(r.universeObjectId.systemCoordinates)))return[3,8];return[4,(0,eB.UX)("Cannot load universe coordinates: system model not found. The loading procedure has been aborted.",t.soundPlayer)];case 7:return s.sent(),[2];case 8:var u;return o=eV.J.Deserialize(e.player,t.starSystemDatabase),t.player.copyFrom(o,t.starSystemDatabase),t.player.discoveries.uploaded.forEach((u=tR(function(e){return tN(this,function(n){switch(n.label){case 0:return[4,t.encyclopaedia.contributeDiscoveryIfNew(e)];case 1:return n.sent(),[2]}})}),function(e){return u.apply(this,arguments)})),[4,t.starSystemView.resetPlayer()];case 9:return s.sent(),t.engine.loadingScreen.displayLoadingUI(),[4,t.starSystemView.loadStarSystem(i)];case 10:if(s.sent(),0!==t.state)return[3,12];return[4,t.init(!0)];case 11:return s.sent(),[3,13];case 12:t.starSystemView.initStarSystem(),s.label=13;case 13:if("inSpaceship"!==n.type)return[3,15];return[4,t.starSystemView.switchToSpaceshipControls()];case 14:return s.sent(),[3,17];case 15:return[4,t.starSystemView.switchToCharacterControls()];case 16:s.sent(),s.label=17;case 17:return[4,t.loadLocation(r)];case 18:return s.sent(),t.starSystemView.getSpaceshipControls().getActiveCamera().getViewMatrix(!0),t.starSystemView.getStarSystem().applyFloatingOrigin(),t.engine.loadingScreen.hideLoadingUI(),void 0!==t.player.currentItinerary[1]&&t.starSystemView.setSystemAsTarget(t.player.currentItinerary[1]),[2]}})})()}},{key:"loadLocation",value:function(e){var t=this;return tR(function(){return tN(this,function(n){switch(n.label){case 0:if("relative"!==e.type)return[3,2];return[4,t.loadRelativeLocation(e)];case 1:return n.sent(),[3,4];case 2:if("atStation"!==e.type)return[3,4];return[4,t.loadAtStationLocation(e)];case 3:n.sent(),n.label=4;case 4:return[2]}})})()}},{key:"loadRelativeLocation",value:function(e){var t=this;return tR(function(){var n,r,a,i,u,l;return tN(this,function(c){switch(c.label){case 0:if(n=t.starSystemView.scene.getActiveControls().getTransform(),void 0!==(a=(r=t.starSystemView.getStarSystem()).getOrbitalObjectById(e.universeObjectId.idInSystem)))return[3,2];return i=r.getStellarObjects()[0],(0,eW.gr)(i,new s.P(0,0,4*i.getBoundingRadius()),new o._f(0,0,0,1),n),[4,(0,eB.UX)("The object you are trying to spawn near to could not be found. You will spawn around the first stellar object of the system instead.",t.soundPlayer)];case 1:return c.sent(),[2];case 2:return(0,eW.gr)(a,new s.P(e.position.x,e.position.y,e.position.z),new o._f(e.rotation.x,e.rotation.y,e.rotation.z,e.rotation.w),n),(u=s.P.Distance(n.getAbsolutePosition(),a.getTransform().getAbsolutePosition()))<1.1*(l=a.getBoundingRadius())&&(u<.1?n.position.addInPlace(new s.P(0,0,5*l)):n.position.scaleInPlace(1.1*l/u)),t.starSystemView.targetCursorLayer.setTarget(a),t.starSystemView.spaceShipLayer.setTarget(a.getTransform()),[2]}})})()}},{key:"loadAtStationLocation",value:function(e){var t=this;return tR(function(){var n,r,a,i,u,l;return tN(this,function(c){switch(c.label){case 0:if(n=t.starSystemView.scene.getActiveControls().getTransform(),void 0!==(a=(r=t.starSystemView.getStarSystem()).getOrbitalObjectById(e.universeObjectId.idInSystem))&&(a.type===O.o.SPACE_STATION||a.type===O.o.SPACE_ELEVATOR))return[3,2];return i=r.getStellarObjects()[0],(0,eW.gr)(i,new s.P(0,0,4*i.getBoundingRadius()),new o._f(0,0,0,1),n),[4,(0,eB.UX)("The space station you are trying to spawn at could not be found. You will spawn around the first stellar object of the system instead.",t.soundPlayer)];case 1:case 3:return c.sent(),[2];case 2:if(void 0!==(u=a.getLandingPadManager().getAvailableLandingPads().at(0)))return[3,4];return l=a,(0,eW.gr)(l,new s.P(0,0,4*l.getBoundingRadius()),new o._f(0,0,0,1),n),[4,(0,eB.UX)("There are no available pads at the space station you are trying to spawn at. You have been moved outside of the station instead.",t.soundPlayer)];case 4:return t.starSystemView.getSpaceshipControls().getSpaceship().spawnOnPad(u),[2]}})})()}}],t=[{key:"CreateAsync",value:function(){return tR(function(){var e,t,o,u,l,v,m,y,b,g,w,E,P,C,T;return tN(this,function(O){switch(O.label){case 0:if((e=document.getElementById("renderer")).width=window.innerWidth,e.height=window.innerHeight,t=new ex.a(e),!window.location.search.includes("webgpu"))return[3,2];return[4,i.u.CreateAsync(e,{twgslOptions:{wasmPath:new URL(n(43808),n.b).href,jsPath:new URL(n(78996),n.b).href},audioEngine:!0})];case 1:return u=O.sent(),[3,3];case 2:u=new a.D(e,!0,{preserveDrawingBuffer:!0,useHighPrecisionMatrix:!0,doNotHandleContextLost:!0,audioEngine:!0}),O.label=3;case 3:return(o=u).useReverseDepthBuffer=!0,o.loadingScreen=t,o.loadingScreen.displayLoadingUI(),window.addEventListener("resize",function(){e.width=window.innerWidth,e.height=window.innerHeight,o.resize(!0)}),[4,(0,eZ.L)()];case 4:return O.sent(),console.log("API: ".concat(o.isWebGPU?"WebGPU":"WebGL")),console.log("GPU detected: ".concat(o.extractDriverInfo())),[4,(0,d.Z)()];case 5:return l=O.sent(),console.log("Havok initialized"),v=new k.Z((0,L.D)()),v.registerGeneralPlugin(function(e){return(0,tI.q)([e.coordinates.starSectorX,e.coordinates.starSectorY,e.coordinates.starSectorZ,e.coordinates.localX,e.coordinates.localY,e.coordinates.localZ])>.5},function(e){var t=e.stellarObjects.map(function(e){return e.id});return e.anomalies.push((0,I.C)(t)),e}),m=eV.J.Default(v),(y=new h.t).backends.push(new f.O(v)),(b=new e_.E(o)).useRightHandedSystem=!0,(g=new c.a(!0,l)).setVelocityLimits(1e4,1e4),b.enablePhysics(s.P.Zero(),g),[4,function(e,t){return eT.apply(this,arguments)}(function(e,n){t.setProgressPercentage(e/n*100)},b)];case 6:return w=O.sent(),E=new ek.st(w.audio.sounds),P=new eM.Ae(w.audio.speakerVoiceLines),[4,(C=new eN.p(b,m,o,g,y,v,E,P,w.rendering)).resetPlayer()];case 7:if(O.sent(),navigator.keyboard)return[3,9];return[4,(0,eB.UX)("Your keyboard layout could not be detected. The QWERTY layout will be assumed by default.",E)];case 8:O.sent(),O.label=9;case 9:return[4,A.CreateAsync(new S,v)];case 10:if((T=O.sent()).success)return[3,12];return[4,(0,eB.UX)((0,p.M)(T.error),E)];case 11:throw O.sent(),Error("Failed to create save manager");case 12:return[2,new r(m,o,w,C,y,v,T.value,E,P)]}})})()}}],e&&tV(r.prototype,e),t&&tV(r,t),r}()},14280:function(e,t,n){n.d(t,{Iu:()=>o,QB:()=>v,Sf:()=>c,Sl:()=>m,U1:()=>u,XT:()=>s,cs:()=>f,fx:()=>b,gM:()=>h,jw:()=>l,nA:()=>d,tW:()=>y});var r=n(49226),a=n(51971),i=n(42933);function o(e,t){e.setAbsolutePosition(e.getAbsolutePosition().add(t)),e.computeWorldMatrix(!0)}function s(e,t,n,r){e.rotateAround(t,n,r),e.computeWorldMatrix(!0)}function u(e,t,n){e.rotate(t,n,r.T.WORLD)}function l(e){if(null===e.rotationQuaternion)throw Error("Null quaternion for ".concat(e.name));return e.rotationQuaternion}function c(e,t){e.rotationQuaternion=t,e.computeWorldMatrix(!0)}function d(e,t){if(!t.equalsWithEpsilon(e.up,1e-7)){var n=e.up;u(e,a.P.Cross(t,n),-Math.acos(a.P.Dot(t,n)))}}function f(e){return e.getDirection(i.F.FORWARD)}function h(e){return e.getDirection(i.F.UP)}function v(e){return p(e).negate()}function p(e){return e.getDirection(i.F.LEFT)}function m(e,t){u(e,f(e),t)}function y(e,t){u(e,p(e),t)}function b(e,t){u(e,h(e),t)}},91822:function(e,t,n){function r(e,t,n){return(0x466f45d*e^0x127409f*t^0x4f9ffb7*n)%1e9}function a(e){var t=0x811c9dc5,n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;t^=s,t=Math.imul(t,0x1000193)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return(t>>>=0)/0xffffffff}n.d(t,{Z:()=>r,q:()=>a})},9852:function(e,t,n){n.d(t,{o:()=>a});var r=n(78479).z.object({});function a(e){try{return r.parse(JSON.parse(e))}catch(e){return null}}},31796:function(e,t,n){n.d(t,{CW:()=>o,Ec:()=>l,Qc:()=>d,a2:()=>u,oZ:()=>c,p5:()=>s,r_:()=>i,th:()=>function e(t,n){return 0===n?t:e(n,t%n)},uZ:()=>a});var r=n(51971);function a(e,t,n){return Math.min(Math.max(e,t),n)}function i(e,t,n){return e>t?Math.max(t,e-n):Math.min(t,e+n)}function o(e,t,n){var r=Math.min(1,Math.max(0,(n-e)/(t-e)));return r*r*(3-2*r)}function s(e){return 2*Math.abs(e-Math.floor(e+.5))}function u(e,t,n,r,a){return r+(e-t)*(a-r)/(n-t)}function l(e,t,n,r){return t+(e-t)*Math.pow(2,-r/n)}function c(e,t,n,a,i){return r._f.SlerpToRef(e,t,Math.pow(2,-a/n),i)}function d(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=t,a=0;a<n;a++){var i=e(r);if(1e-8>Math.abs(i))break;var o=(e(r+1e-4)-i)/1e-4;r-=i/o}return r}},24660:function(e,t,n){n.d(t,{_T:()=>c,gr:()=>s,pl:()=>u,xM:()=>l});var r=n(68645),a=n(51971),i=n(14280);function o(e,t){var n=-1,r=t[0];if(void 0===r)throw Error("no bodieees !");var a=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var l=s.value,c=e.subtract(l.getTransform().getAbsolutePosition()).length();(-1===n||c<n)&&(r=l,n=c)}}catch(e){i=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}return r}function s(e,t,n,r){var o=e.getBoundingRadius(),s=t.length(),u=Math.max(2*o,s),l=e.getTransform().getWorldMatrix(),c=a.P.TransformCoordinates(t.scale(u/(s+1e-4)),l);r.setAbsolutePosition(c);var d=e.getTransform().absoluteRotationQuaternion,f=n.multiply(d);(0,i.Sf)(r,f)}function u(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,i=o(t.getTransform().getAbsolutePosition(),n.getStellarObjects());if(i===t)e.getTransform().setAbsolutePosition(t.getTransform().getAbsolutePosition().add(new a.P(0,.2,1).scaleInPlace(t.getBoundingRadius()*r)));else{var s=t.getTransform().getAbsolutePosition().subtract(i.getTransform().getAbsolutePosition()),u=s.length();s.scaleInPlace(1/u);var l=i.getTransform().getAbsolutePosition().add(s.scale(u-r*t.getBoundingRadius()));e.getTransform().setAbsolutePosition(l)}n.translateEverythingNow(e.getTransform().getAbsolutePosition().negate()),e.getTransform().setAbsolutePosition(a.P.Zero()),e.getTransform().lookAt(t.getTransform().getAbsolutePosition())}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,s=o(t.getTransform().getAbsolutePosition(),n.getStellarObjects());if(s===t)e.getTransform().setAbsolutePosition(t.getTransform().getAbsolutePosition().add(new a.P(0,.2,1).scaleInPlace(t.getBoundingRadius()*r)));else{var u=t.getTransform().getAbsolutePosition().subtract(s.getTransform().getAbsolutePosition()),l=u.length();u.scaleInPlace(1/l);var c=(0,i.gM)(t.getTransform()),d=a.P.Cross(u,c),f=s.getTransform().getAbsolutePosition().add(u.scale(l+1.5*t.getBoundingRadius())).add(d.scale(4*t.getBoundingRadius()));e.getTransform().setAbsolutePosition(f),(0,i.XT)(e.getTransform(),t.getTransform().getAbsolutePosition(),u,-Math.PI/16)}n.translateEverythingNow(e.getTransform().getAbsolutePosition().negate()),e.getTransform().setAbsolutePosition(a.P.Zero());var h=s.getTransform().getAbsolutePosition().subtract(t.getTransform().getAbsolutePosition()).normalize(),v=t.getTransform().getAbsolutePosition().add(h.scale(4*t.getBoundingRadius()));e.getTransform().lookAt(v),e.getTransform().computeWorldMatrix(!0),(0,i.Sl)(e.getTransform(),-Math.PI/8),e.getActiveCamera().getViewMatrix(!0),e.getActiveCamera().getProjectionMatrix(!0)}function c(e,t,n){var s=e.asteroidField;if(null===s)throw Error("The body does not have an asteroid field");var u=e.getTransform().getAbsolutePosition(),l=(0,r.Lerp)(s.minRadius,s.maxRadius,n),c=o(u,t.getStellarObjects()),d=u.subtract(c.getTransform().getAbsolutePosition()).normalize(),f=(0,i.gM)(e.getTransform()),h=a.P.Cross(d,f).normalize();return u.add(h.scale(l)).add(f.scale(s.patchThickness))}},91307:function(e,t,n){function r(e){var t=[];return e.children.forEach(function(n,r){"x"!==r&&"y"!==r&&t.push([r,e.name])}),t}function a(e,t){var n=[];if(e.children.forEach(function(e,r){if("x"!==r&&"y"!==r){var a,i,o=e.name;o=o.replace("key:",""),o=null!=(i=null==t||null==(a=t.get(o))?void 0:a.toUpperCase())?i:o,n.push([r,o])}}),void 0===n[0]||void 0===n[1]||void 0===n[2]||void 0===n[3])throw Error("DPadComposite keys are undefined");return[n[2],n[0],n[3],n[1]]}function i(){return[["x","pointerX"],["y","pointerY"]]}function o(e,t){var n,r,a=e.name;return a=a.replace("key:",""),a=null!=(r=null==t||null==(n=t.get(a))?void 0:n.toUpperCase())?r:a}function s(e,t){var n=[];return e.children.forEach(function(e,r){var a,i,o=e.name;o=o.replace("key:",""),o=null!=(i=null==t||null==(a=t.get(o))?void 0:a.toUpperCase())?i:o,n.push([r,o])}),n}function u(e,t){return e.action.bindings.map(function(e){return o(e.control,t)})}n.d(t,{C9:()=>s,JT:()=>r,cs:()=>a,gG:()=>i,gW:()=>u,x_:()=>o})}}]);