"use strict";(globalThis.webpackChunkcosmos_journeyer=globalThis.webpackChunkcosmos_journeyer||[]).push([["4223"],{14694:function(e,t,r){r.a(e,async function(e,i){try{r.d(t,{LD:()=>n.LD,QB:()=>n.QB,co:()=>n.co});var s=r(61693),n=r(55845),a=e([s]);s=(a.then?(await a)():a)[0],(0,n.oT)(s),i()}catch(e){i(e)}})},55845:function(e,t,r){let i;function s(e){i=e}r.d(t,{LD:()=>C,Or:()=>y,QB:()=>g,T2:()=>v,co:()=>m,oT:()=>s,ug:()=>x}),e=r.hmd(e);let n=null;function a(){return(null===n||0===n.byteLength)&&(n=new Uint8Array(i.memory.buffer)),n}let o=Array(128).fill(void 0);o.push(void 0,null,!0,!1);let l=o.length,h=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});function u(e,t){if(!(e instanceof t))throw Error(`expected instance of ${t.name}`);return e.ptr}h.decode();let c=null,_=0;function d(e,t){let r=t(4*e.length,4)>>>0;return((null===c||0===c.byteLength)&&(c=new Float32Array(i.memory.buffer)),c).set(e,r/4),_=e.length,r}function f(e){l===o.length&&o.push(o.length+1);let t=l;return l=o[t],o[t]=e,t}let p=null;function g(e,t,r,s,n,a,o){u(e,m);var l=d(t,i.__wbindgen_malloc),h=_,c=function(e,t){let r=t(2*e.length,2)>>>0;return((null===p||0===p.byteLength)&&(p=new Uint16Array(i.memory.buffer)),p).set(e,r/2),_=e.length,r}(r,i.__wbindgen_malloc),g=_,C=d(s,i.__wbindgen_malloc),v=_,x=d(n,i.__wbindgen_malloc),y=_,S=d(a,i.__wbindgen_malloc),w=_;let F=i.build_chunk_vertex_data(e.__wbg_ptr,l,h,f(t),c,g,f(r),C,v,f(s),x,y,f(n),S,w,f(a),o);return b.__wrap(F)}Object.freeze({Up:0,0:"Up",Down:1,1:"Down",Left:2,2:"Left",Right:3,3:"Right",Forward:4,4:"Forward",Backward:5,5:"Backward"});class m{__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){let e=this.__destroy_into_raw();i.__wbg_builddata_free(e)}get planet_diameter(){return i.__wbg_get_builddata_planet_diameter(this.__wbg_ptr)}set planet_diameter(e){i.__wbg_set_builddata_planet_diameter(this.__wbg_ptr,e)}get chunk_depth(){return i.__wbg_get_builddata_chunk_depth(this.__wbg_ptr)>>>0}set chunk_depth(e){i.__wbg_set_builddata_chunk_depth(this.__wbg_ptr,e)}get chunk_tree_direction(){return i.__wbg_get_builddata_chunk_tree_direction(this.__wbg_ptr)}set chunk_tree_direction(e){i.__wbg_set_builddata_chunk_tree_direction(this.__wbg_ptr,e)}get chunk_cube_position_x(){return i.__wbg_get_builddata_chunk_cube_position_x(this.__wbg_ptr)}set chunk_cube_position_x(e){i.__wbg_set_builddata_chunk_cube_position_x(this.__wbg_ptr,e)}get chunk_cube_position_y(){return i.__wbg_get_builddata_chunk_cube_position_y(this.__wbg_ptr)}set chunk_cube_position_y(e){i.__wbg_set_builddata_chunk_cube_position_y(this.__wbg_ptr,e)}get chunk_cube_position_z(){return i.__wbg_get_builddata_chunk_cube_position_z(this.__wbg_ptr)}set chunk_cube_position_z(e){i.__wbg_set_builddata_chunk_cube_position_z(this.__wbg_ptr,e)}get planet_seed(){return i.__wbg_get_builddata_planet_seed(this.__wbg_ptr)}set planet_seed(e){i.__wbg_set_builddata_planet_seed(this.__wbg_ptr,e)}get resolution(){return i.__wbg_get_builddata_resolution(this.__wbg_ptr)>>>0}set resolution(e){i.__wbg_set_builddata_resolution(this.__wbg_ptr,e)}get terrain_settings(){let e=i.__wbg_get_builddata_terrain_settings(this.__wbg_ptr);return C.__wrap(e)}set terrain_settings(e){u(e,C);var t=e.__destroy_into_raw();i.__wbg_set_builddata_terrain_settings(this.__wbg_ptr,t)}constructor(e,t,r,s,n,a,o,l,h){u(h,C);var c=h.__destroy_into_raw();let _=i.builddata_new(e,t,r,s,n,a,o,l,c);return this.__wbg_ptr=_>>>0,this}}class b{static __wrap(e){e>>>=0;let t=Object.create(b.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){let e=this.__destroy_into_raw();i.__wbg_returndata_free(e)}get nb_instances_created(){return i.__wbg_get_returndata_nb_instances_created(this.__wbg_ptr)>>>0}set nb_instances_created(e){i.__wbg_set_returndata_nb_instances_created(this.__wbg_ptr,e)}get average_height(){return i.__wbg_get_returndata_average_height(this.__wbg_ptr)}set average_height(e){i.__wbg_set_returndata_average_height(this.__wbg_ptr,e)}}class C{static __wrap(e){e>>>=0;let t=Object.create(C.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){let e=this.__destroy_into_raw();i.__wbg_terrainsettings_free(e)}get continents_frequency(){return i.__wbg_get_terrainsettings_continents_frequency(this.__wbg_ptr)}set continents_frequency(e){i.__wbg_set_terrainsettings_continents_frequency(this.__wbg_ptr,e)}get bumps_frequency(){return i.__wbg_get_terrainsettings_bumps_frequency(this.__wbg_ptr)}set bumps_frequency(e){i.__wbg_set_terrainsettings_bumps_frequency(this.__wbg_ptr,e)}get mountains_frequency(){return i.__wbg_get_terrainsettings_mountains_frequency(this.__wbg_ptr)}set mountains_frequency(e){i.__wbg_set_terrainsettings_mountains_frequency(this.__wbg_ptr,e)}get continents_fragmentation(){return i.__wbg_get_terrainsettings_continents_fragmentation(this.__wbg_ptr)}set continents_fragmentation(e){i.__wbg_set_terrainsettings_continents_fragmentation(this.__wbg_ptr,e)}get continent_base_height(){return i.__wbg_get_terrainsettings_continent_base_height(this.__wbg_ptr)}set continent_base_height(e){i.__wbg_set_terrainsettings_continent_base_height(this.__wbg_ptr,e)}get max_mountain_height(){return i.__wbg_get_terrainsettings_max_mountain_height(this.__wbg_ptr)}set max_mountain_height(e){i.__wbg_set_terrainsettings_max_mountain_height(this.__wbg_ptr,e)}get max_bump_height(){return i.__wbg_get_terrainsettings_max_bump_height(this.__wbg_ptr)}set max_bump_height(e){i.__wbg_set_terrainsettings_max_bump_height(this.__wbg_ptr,e)}constructor(){let e=i.terrainsettings_new();return this.__wbg_ptr=e>>>0,this}}function v(e,t,r){var i;new Uint8Array(o[r].buffer,o[r].byteOffset,o[r].byteLength).set((i=e>>>0,a().subarray(i/1,i/1+t)))}function x(e){!function(e){o[e],e<132||(o[e]=l,l=e)}(e)}function y(e,t){var r;throw Error((r=e>>>0,h.decode(a().subarray(r,r+t))))}},67552:function(e,t,r){r.d(t,{Ku:()=>F,aK:()=>w,wz:()=>y,An:()=>S,xd:()=>U,PM:()=>D});class i{constructor(){this.children=[]}isValid(e){return!0}process(e,t,r){let i="";if(this.line){let r=this.line,s=t.processor;if(s){s.lineProcessor&&(r=s.lineProcessor(r,t.isFragment,t.processingContext));let i=t.processor?.attributeKeywordName??"attribute",n=t.isFragment&&t.processor?.varyingFragmentKeywordName?t.processor?.varyingFragmentKeywordName:!t.isFragment&&t.processor?.varyingVertexKeywordName?t.processor?.varyingVertexKeywordName:"varying";!t.isFragment&&s.attributeProcessor&&this.line.startsWith(i)?r=s.attributeProcessor(this.line,e,t.processingContext):s.varyingProcessor&&(s.varyingCheck?.(this.line,t.isFragment)||!s.varyingCheck&&this.line.startsWith(n))?r=s.varyingProcessor(this.line,t.isFragment,e,t.processingContext):s.uniformProcessor&&s.uniformRegexp&&s.uniformRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(r=s.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):s.uniformBufferProcessor&&s.uniformBufferRegexp&&s.uniformBufferRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(r=s.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0):s.textureProcessor&&s.textureRegexp&&s.textureRegexp.test(this.line)?r=s.textureProcessor(this.line,t.isFragment,e,t.processingContext):(s.uniformProcessor||s.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?s.uniformProcessor&&(r=s.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):s.uniformBufferProcessor&&(r=s.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)),t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,s.endOfUniformBufferProcessor&&(r=s.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}i+=r+"\n"}for(let s of this.children)i+=s.process(e,t,r);return this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true",r[this.additionalDefineKey]=e[this.additionalDefineKey]),i}}class s{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(e){for(let t of(this._lines.length=0,e)){if(!t||"\r"===t)continue;if("#"===t[0]){this._lines.push(t);continue}let e=t.trim();if(!e)continue;if(e.startsWith("//")){this._lines.push(t);continue}let r=e.indexOf(";");if(-1===r)this._lines.push(e);else if(r===e.length-1)e.length>1&&this._lines.push(e);else{let e=t.split(";");for(let t=0;t<e.length;t++){let r=e[t];r&&(r=r.trim())&&this._lines.push(r+(t!==e.length-1?";":""))}}}}}class n extends i{process(e,t,r){for(let i=0;i<this.children.length;i++){let s=this.children[i];if(s.isValid(e))return s.process(e,t,r)}return""}}class a extends i{isValid(e){return this.testExpression.isTrue(e)}}class o{isTrue(e){return!0}static postfixToInfix(e){let t=[];for(let r of e)if(void 0===o._OperatorPriority[r])t.push(r);else{let e=t[t.length-1],i=t[t.length-2];t.length-=2,t.push(`(${i}${r}${e})`)}return t[t.length-1]}static infixToPostfix(e){let t=o._InfixToPostfixCache.get(e);if(t)return t.accessTime=Date.now(),t.result;if(!e.includes("&&")&&!e.includes("||")&&!e.includes(")")&&!e.includes("("))return[e];let r=[],i=-1,s=()=>{""!==(u=u.trim())&&(r.push(u),u="")},n=e=>{i<o._Stack.length-1&&(o._Stack[++i]=e)},a=()=>o._Stack[i],l=()=>-1===i?"!!INVALID EXPRESSION!!":o._Stack[i--],h=0,u="";for(;h<e.length;){let t=e.charAt(h),c=h<e.length-1?e.substring(h,2+h):"";if("("===t)u="",n(t);else if(")"===t){for(s();-1!==i&&"("!==a();)r.push(l());l()}else if(o._OperatorPriority[c]>1){for(s();-1!==i&&o._OperatorPriority[a()]>=o._OperatorPriority[c];)r.push(l());n(c),h++}else u+=t;h++}for(s();-1!==i;)"("===a()?l():r.push(l());return o._InfixToPostfixCache.size>=o.InfixToPostfixCacheLimitSize&&o.ClearCache(),o._InfixToPostfixCache.set(e,{result:r,accessTime:Date.now()}),r}static ClearCache(){let e=Array.from(o._InfixToPostfixCache.entries()).sort((e,t)=>e[1].accessTime-t[1].accessTime);for(let t=0;t<o.InfixToPostfixCacheCleanupSize;t++)o._InfixToPostfixCache.delete(e[t][0])}}o.InfixToPostfixCacheLimitSize=5e4,o.InfixToPostfixCacheCleanupSize=25e3,o._InfixToPostfixCache=new Map,o._OperatorPriority={")":0,"(":1,"||":2,"&&":3},o._Stack=["","","","","","","","","","","","","","","","","","","",""];class l extends o{constructor(e,t=!1){super(),this.define=e,this.not=t}isTrue(e){let t=void 0!==e[this.define];return this.not&&(t=!t),t}}class h extends o{isTrue(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}class u extends o{isTrue(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}class c extends o{constructor(e,t,r){super(),this.define=e,this.operand=t,this.testValue=r}isTrue(e){let t=!1,r=parseInt(void 0!=e[this.define]?e[this.define]:this.define),i=parseInt(void 0!=e[this.testValue]?e[this.testValue]:this.testValue);switch(this.operand){case">":t=r>i;break;case"<":t=r<i;break;case"<=":t=r<=i;break;case">=":t=r>=i;break;case"==":t=r===i;break;case"!=":t=r!==i}return t}}var _=r(9139),d=r(88173);let f=/defined\s*?\((.+?)\)/g,p=/defined\s*?\[(.+?)\]/g,g=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,m=/__decl__/,b=/light\{X\}.(\w*)/g,C=/\{X\}/g,v=[],x=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function y(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}function S(e,t,r,i){t.processor?.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),U(e,t,e=>{t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e,t.defines)),r(function(e,t,r){let i=function(e,t){if(t.processor?.noPrecision)return e;let r=t.shouldUseHighPrecisionShader;return -1===e.indexOf("precision highp float")?e=r?"precision highp float;\n"+e:"precision mediump float;\n"+e:r||(e=e.replace("precision highp float","precision mediump float")),e}(e,t);if(!t.processor||0===t.processor.shaderLanguage&&-1!==i.indexOf("#version 3")&&(i=i.replace("#version 300 es",""),!t.processor.parseGLES3))return i;let s=t.defines,n=L(t,r);t.processor.preProcessor&&(i=t.processor.preProcessor(i,s,n,t.isFragment,t.processingContext));let a={};return i=E(i,n,t,a),t.processor.postProcessor&&(i=t.processor.postProcessor(i,s,t.isFragment,t.processingContext,r?{drawBuffersExtensionDisabled:!r.getCaps().drawBuffersExtension}:{},n,a)),r?._features.needShaderCodeInlining&&(i=r.inlineShaderCode(i)),i}(e,t,i),e)})}function w(e,t,r,i){t.processor?.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),U(e,t,e=>{t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e,t.defines)),r(function(e,t,r){let i=e,s=t.defines,n=L(t,r);t.processor?.preProcessor&&(i=t.processor.preProcessor(i,s,n,t.isFragment,t.processingContext));let a={};return i=E(i,n,t,a),t.processor?.postProcessor&&(i=t.processor.postProcessor(i,s,t.isFragment,t.processingContext,r?{drawBuffersExtensionDisabled:!r.getCaps().drawBuffersExtension}:{},n,a)),r._features.needShaderCodeInlining&&(i=r.inlineShaderCode(i)),i}(e,t,i),e)})}function F(e,t,r){return r.processor&&r.processor.finalizeShaders?r.processor.finalizeShaders(e,t,r.processingContext):{vertexCode:e,fragmentCode:t}}function P(e){let t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new l(t[1].trim(),"!"===e[0]);let r="",i=0;for(r of["==","!=",">=","<=","<",">"])if((i=e.indexOf(r))>-1)break;if(-1===i)return new l(e);let s=e.substring(0,i).trim(),n=e.substring(i+r.length).trim();return new c(s,r,n)}function A(e,t){let r=new a,i=e.substring(0,t),s=e.substring(t);return s=s.substring(0,(s.indexOf("//")+1||s.length+1)-1).trim(),"#ifdef"===i?r.testExpression=new l(s):"#ifndef"===i?r.testExpression=new l(s,!0):r.testExpression=function(e){e=e.replace(f,"defined[$1]");let t=o.infixToPostfix(e),r=[];for(let e of t)if("||"!==e&&"&&"!==e)r.push(e);else if(r.length>=2){let t=r[r.length-1],i=r[r.length-2];r.length-=2;let s="&&"==e?new u:new h;"string"==typeof t&&(t=t.replace(p,"defined($1)")),"string"==typeof i&&(i=i.replace(p,"defined($1)")),s.leftOperand="string"==typeof i?P(i):i,s.rightOperand="string"==typeof t?P(t):t,r.push(s)}let i=r[r.length-1];return"string"==typeof i&&(i=i.replace(p,"defined($1)")),"string"==typeof i?P(i):i}(s),r}function T(e,t,r,s){let n=e.currentLine;for(;R(e,r,s);){let a=(n=e.currentLine).substring(0,5).toLowerCase();if("#else"===a){let r=new i;t.children.push(r),R(e,r,s);return}if("#elif"===a){let e=A(n,5);t.children.push(e),r=e}}}function R(e,t,r){for(;e.canRead;){e.lineIndex++;let s=e.currentLine;if(s.indexOf("#")>=0){let i=x.exec(s);if(i&&i.length){switch(i[0]){case"#ifdef":{let i=new n;t.children.push(i);let a=A(s,6);i.children.push(a),T(e,i,a,r);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{let i=new n;t.children.push(i);let a=A(s,7);i.children.push(a),T(e,i,a,r);break}case"#if":{let i=new n,a=A(s,3);t.children.push(i),i.children.push(a),T(e,i,a,r)}}continue}}let a=new i;if(a.line=s,t.children.push(a),"#"===s[0]&&"d"===s[1]){let e=s.replace(";","").split(" ");a.additionalDefineKey=e[1],3===e.length&&(a.additionalDefineValue=e[2])}}return!1}function E(e,t,r,n){let a=new i,o=new s;return o.lineIndex=-1,o.lines=e.split("\n"),R(o,a,n),a.process(t,r,n)}function L(e,t){let r=e.defines,i={};for(let e of r){let t=e.replace("#define","").replace(";","").trim().split(" ");i[t[0]]=t.length>1?t[1]:""}return e.processor?.shaderLanguage===0&&(i.GL_ES="true"),i.__VERSION__=e.version,i[e.platformName]="true",(0,d.sk)(i,t?.isNDCHalfZRange,t?.useReverseDepthBuffer,t?.useExactSrgbConversions),i}function U(e,t,r){let i;for(v.length=0;null!==(i=g.exec(e));)v.push(i);let s=String(e),n=[e],a=!1;for(let e of v){let i=e[1];if(-1!==i.indexOf("__decl__")&&(i=i.replace(m,""),t.supportsUniformBuffers&&(i=i.replace("Vertex","Ubo").replace("Fragment","Ubo")),i+="Declaration"),t.includesShadersStore[i]){let r=t.includesShadersStore[i];if(e[2]){let t=e[3].split(",");for(let e=0;e<t.length;e+=2){let i=RegExp(t[e],"g"),s=t[e+1];r=r.replace(i,s)}}if(e[4]){let i=e[5];if(-1!==i.indexOf("..")){let e=i.split(".."),s=parseInt(e[0]),n=parseInt(e[1]),a=r.slice(0);r="",isNaN(n)&&(n=t.indexParameters[e[1]]);for(let e=s;e<n;e++)t.supportsUniformBuffers||(a=a.replace(b,(e,t)=>t+"{X}")),r+=a.replace(C,e.toString())+"\n"}else t.supportsUniformBuffers||(r=r.replace(b,(e,t)=>t+"{X}")),r=r.replace(C,i)}let s=[];for(let t of n){let i=t.split(e[0]);for(let e=0;e<i.length-1;e++)s.push(i[e]),s.push(r);s.push(i[i.length-1])}n=s,a=a||r.indexOf("#include<")>=0||r.indexOf("#include <")>=0}else{let e=t.shadersRepository+"ShadersInclude/"+i+".fx";D.loadFile(e,e=>{t.includesShadersStore[i]=e,U(n.join(""),t,r)});return}}v.length=0,s=n.join(""),a?U(s.toString(),t,r):r(s)}let D={loadFile:(e,t,r,i,s,n)=>{throw(0,_.S)("FileTools")}}},3199:function(e,t,r){r.d(t,{y:()=>i});class i{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(e){e&&this.program&&e(this.program)}setEngine(e){this.engine=e}_fillEffectInformation(e,t,r,i,s,n,a,o){let l,h=this.engine;if(h.supportsUniformBuffers)for(let r in t)e.bindUniformBlock(r,t[r]);for(this.engine.getUniforms(this,r).forEach((e,t)=>{i[r[t]]=e}),this._uniforms=i,l=0;l<s.length;l++)null==e.getUniform(s[l])&&(s.splice(l,1),l--);for(let e of(s.forEach((e,t)=>{n[e]=t}),h.getAttributes(this,a)))o.push(e)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(e,t){let r=this._valueCache[e],i=t.updateFlag;return(void 0===r||r!==i)&&(this._valueCache[e]=i,!0)}_cacheFloat2(e,t,r){let i=this._valueCache[e];if(!i||2!==i.length)return i=[t,r],this._valueCache[e]=i,!0;let s=!1;return i[0]!==t&&(i[0]=t,s=!0),i[1]!==r&&(i[1]=r,s=!0),s}_cacheFloat3(e,t,r,i){let s=this._valueCache[e];if(!s||3!==s.length)return s=[t,r,i],this._valueCache[e]=s,!0;let n=!1;return s[0]!==t&&(s[0]=t,n=!0),s[1]!==r&&(s[1]=r,n=!0),s[2]!==i&&(s[2]=i,n=!0),n}_cacheFloat4(e,t,r,i,s){let n=this._valueCache[e];if(!n||4!==n.length)return n=[t,r,i,s],this._valueCache[e]=n,!0;let a=!1;return n[0]!==t&&(n[0]=t,a=!0),n[1]!==r&&(n[1]=r,a=!0),n[2]!==i&&(n[2]=i,a=!0),n[3]!==s&&(n[3]=s,a=!0),a}setInt(e,t){let r=this._valueCache[e];(void 0===r||r!==t)&&this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}setInt2(e,t,r){this._cacheFloat2(e,t,r)&&!this.engine.setInt2(this._uniforms[e],t,r)&&(this._valueCache[e]=null)}setInt3(e,t,r,i){this._cacheFloat3(e,t,r,i)&&!this.engine.setInt3(this._uniforms[e],t,r,i)&&(this._valueCache[e]=null)}setInt4(e,t,r,i,s){this._cacheFloat4(e,t,r,i,s)&&!this.engine.setInt4(this._uniforms[e],t,r,i,s)&&(this._valueCache[e]=null)}setIntArray(e,t){this._valueCache[e]=null,this.engine.setIntArray(this._uniforms[e],t)}setIntArray2(e,t){this._valueCache[e]=null,this.engine.setIntArray2(this._uniforms[e],t)}setIntArray3(e,t){this._valueCache[e]=null,this.engine.setIntArray3(this._uniforms[e],t)}setIntArray4(e,t){this._valueCache[e]=null,this.engine.setIntArray4(this._uniforms[e],t)}setUInt(e,t){let r=this._valueCache[e];(void 0===r||r!==t)&&this.engine.setUInt(this._uniforms[e],t)&&(this._valueCache[e]=t)}setUInt2(e,t,r){this._cacheFloat2(e,t,r)&&!this.engine.setUInt2(this._uniforms[e],t,r)&&(this._valueCache[e]=null)}setUInt3(e,t,r,i){this._cacheFloat3(e,t,r,i)&&!this.engine.setUInt3(this._uniforms[e],t,r,i)&&(this._valueCache[e]=null)}setUInt4(e,t,r,i,s){this._cacheFloat4(e,t,r,i,s)&&!this.engine.setUInt4(this._uniforms[e],t,r,i,s)&&(this._valueCache[e]=null)}setUIntArray(e,t){this._valueCache[e]=null,this.engine.setUIntArray(this._uniforms[e],t)}setUIntArray2(e,t){this._valueCache[e]=null,this.engine.setUIntArray2(this._uniforms[e],t)}setUIntArray3(e,t){this._valueCache[e]=null,this.engine.setUIntArray3(this._uniforms[e],t)}setUIntArray4(e,t){this._valueCache[e]=null,this.engine.setUIntArray4(this._uniforms[e],t)}setArray(e,t){this._valueCache[e]=null,this.engine.setArray(this._uniforms[e],t)}setArray2(e,t){this._valueCache[e]=null,this.engine.setArray2(this._uniforms[e],t)}setArray3(e,t){this._valueCache[e]=null,this.engine.setArray3(this._uniforms[e],t)}setArray4(e,t){this._valueCache[e]=null,this.engine.setArray4(this._uniforms[e],t)}setMatrices(e,t){t&&(this._valueCache[e]=null,this.engine.setMatrices(this._uniforms[e],t))}setMatrix(e,t){this._cacheMatrix(e,t)&&!this.engine.setMatrices(this._uniforms[e],t.asArray())&&(this._valueCache[e]=null)}setMatrix3x3(e,t){this._valueCache[e]=null,this.engine.setMatrix3x3(this._uniforms[e],t)}setMatrix2x2(e,t){this._valueCache[e]=null,this.engine.setMatrix2x2(this._uniforms[e],t)}setFloat(e,t){let r=this._valueCache[e];(void 0===r||r!==t)&&this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)}setVector2(e,t){this._cacheFloat2(e,t.x,t.y)&&!this.engine.setFloat2(this._uniforms[e],t.x,t.y)&&(this._valueCache[e]=null)}setFloat2(e,t,r){this._cacheFloat2(e,t,r)&&!this.engine.setFloat2(this._uniforms[e],t,r)&&(this._valueCache[e]=null)}setVector3(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&!this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)&&(this._valueCache[e]=null)}setFloat3(e,t,r,i){this._cacheFloat3(e,t,r,i)&&!this.engine.setFloat3(this._uniforms[e],t,r,i)&&(this._valueCache[e]=null)}setVector4(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&!this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)&&(this._valueCache[e]=null)}setQuaternion(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&!this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)&&(this._valueCache[e]=null)}setFloat4(e,t,r,i,s){this._cacheFloat4(e,t,r,i,s)&&!this.engine.setFloat4(this._uniforms[e],t,r,i,s)&&(this._valueCache[e]=null)}setColor3(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&!this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)&&(this._valueCache[e]=null)}setColor4(e,t,r){this._cacheFloat4(e,t.r,t.g,t.b,r)&&!this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,r)&&(this._valueCache[e]=null)}setDirectColor4(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&!this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)&&(this._valueCache[e]=null)}_getVertexShaderCode(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}},88173:function(e,t,r){r.d(t,{A8:()=>l,Gb:()=>n,an:()=>s,sk:()=>o,wv:()=>a});var i=r(9139);r(82090);let s={};function n(e,t,r=""){return r+(t?t+"\n":"")+e}function a(e,t,r,n,a,o,l){let h=l||s.loadFile;if(h)return h(e,t,r,n,a,o);throw(0,i.S)("FileTools")}function o(e,t,r,i){if(e){t?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,r?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,i?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS;return}{let e="";return t&&(e+="#define IS_NDC_HALF_ZRANGE"),r&&(e&&(e+="\n"),e+="#define USE_REVERSE_DEPTHBUFFER"),i&&(e&&(e+="\n"),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}function l(e,t,r=!1,i){switch(e){case 3:{let e=(t instanceof ArrayBuffer,new Int8Array(t));return i&&e.set(new Int8Array(i)),e}case 0:{let e=(t instanceof ArrayBuffer,new Uint8Array(t));return i&&e.set(new Uint8Array(i)),e}case 4:{let e=new Int16Array(t instanceof ArrayBuffer?t:r?t/2:t);return i&&e.set(new Int16Array(i)),e}case 5:case 8:case 9:case 10:case 2:{let e=new Uint16Array(t instanceof ArrayBuffer?t:r?t/2:t);return i&&e.set(new Uint16Array(i)),e}case 6:{let e=new Int32Array(t instanceof ArrayBuffer?t:r?t/4:t);return i&&e.set(new Int32Array(i)),e}case 7:case 11:case 12:case 13:case 14:case 15:{let e=new Uint32Array(t instanceof ArrayBuffer?t:r?t/4:t);return i&&e.set(new Uint32Array(i)),e}case 1:{let e=new Float32Array(t instanceof ArrayBuffer?t:r?t/4:t);return i&&e.set(new Float32Array(i)),e}}let s=(t instanceof ArrayBuffer,new Uint8Array(t));return i&&s.set(new Uint8Array(i)),s}},37384:function(e,t,r){r.d(t,{a:()=>C,l:()=>b});var i=r(66395),s=r(92550),n=r(21389),a=r(77783),o=r(53371),l=r(33149),h=r(51210),u=r(77203),c=r(80982),_=r(9139),d=r(10967),f=r(82090),p=r(67791),g=r(88173),m=r(47816);function b(e,t){if((0,f.CG)()){let{requestAnimationFrame:r}=t||window;if("function"==typeof r)return r(e)}else if("function"==typeof requestAnimationFrame)return requestAnimationFrame(e);return setTimeout(e,16)}class C{get frameId(){return this._frameId}get isWebGPU(){return this._isWebGPU}_getShaderProcessor(e){return this._shaderProcessor}get shaderPlatformName(){return this._shaderPlatformName}_clearEmptyResources(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}get useReverseDepthBuffer(){return this._useReverseDepthBuffer}set useReverseDepthBuffer(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,e?this._depthCullingState.depthFunc=518:this._depthCullingState.depthFunc=515)}setColorWrite(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}_getGlobalDefines(e){if(e){this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,this.useExactSrgbConversions?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS;return}{let e="";return this.isNDCHalfZRange&&(e+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(e&&(e+="\n"),e+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(e&&(e+="\n"),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}_rebuildInternalTextures(){for(let e of this._internalTexturesCache.slice())e._rebuild()}_rebuildRenderTargetWrappers(){for(let e of this._renderTargetWrapperCache.slice())e._rebuild()}_rebuildEffects(){for(let e in this._compiledEffects){let t=this._compiledEffects[e];t._pipelineContext=null,t._prepareEffect()}n.Q.ResetCache()}_rebuildGraphicsResources(){this.wipeCaches(!0),this._rebuildEffects(),this._rebuildComputeEffects?.(),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}_flagContextRestored(){s.Y.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}_restoreEngineAfterContextLost(e){setTimeout(async()=>{this._clearEmptyResources();let t=this._depthCullingState.depthTest,r=this._depthCullingState.depthFunc,i=this._depthCullingState.depthMask,s=this._stencilState.stencilTest;await e(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=r,this._depthCullingState.depthMask=i,this._stencilState.stencilTest=s,this._flagContextRestored()},0)}get isDisposed(){return this._isDisposed}get snapshotRendering(){return!1}set snapshotRendering(e){}get snapshotRenderingMode(){return 0}set snapshotRenderingMode(e){}getClassName(){return"AbstractEngine"}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){let e=new Uint8Array(4);this._emptyCubeTexture=this.createRawCubeTexture([e,e,e,e,e,e],1,5,0,!1,!1,1)}return this._emptyCubeTexture}get activeRenderLoops(){return this._activeRenderLoops}stopRenderLoop(e){if(!e){this._activeRenderLoops.length=0,this._cancelFrame();return}let t=this._activeRenderLoops.indexOf(e);t>=0&&(this._activeRenderLoops.splice(t,1),0==this._activeRenderLoops.length&&this._cancelFrame())}_cancelFrame(){if(0!==this._frameHandler){let e=this._frameHandler;if(this._frameHandler=0,(0,f.CG)()){let{cancelAnimationFrame:t}=this.getHostWindow()||window;if("function"==typeof t)return t(e)}else if("function"==typeof cancelAnimationFrame)return cancelAnimationFrame(e);return clearTimeout(e)}}beginFrame(){this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}get maxFPS(){return this._maxFPS}set maxFPS(e){if(this._maxFPS=e,void 0!==e){if(e<=0){this._minFrameTime=Number.MAX_VALUE;return}this._minFrameTime=1e3/e}}_isOverFrameTime(e){if(!e||void 0===this._maxFPS)return!1;let t=e-this._lastFrameTime;return this._lastFrameTime=e,this._renderAccumulator+=t,this._renderAccumulator<this._minFrameTime||(this._renderAccumulator-=this._minFrameTime,this._renderAccumulator>this._minFrameTime&&(this._renderAccumulator=this._minFrameTime),!1)}_processFrame(e){if(this._frameHandler=0,!this._contextWasLost&&!this._isOverFrameTime(e)){let e=!0;(this.isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e&&(this.beginFrame(),this.skipFrameRender||this._renderViews()||this._renderFrame(),this.endFrame())}}_renderLoop(e){this._processFrame(e),this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++)(0,this._activeRenderLoops[e])()}_renderViews(){return!1}_queueNewFrame(e,t){return b(e,t)}runRenderLoop(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(e){this._depthCullingState.depthTest=e}setZOffset(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e}getZOffset(){let e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e}setZOffsetUnits(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e}getZOffsetUnits(){let e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e}getHostWindow(){return(0,f.CG)()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(e){this._compatibilityMode=!0}_rebuildTextures(){for(let e of this.scenes)e._rebuildTextures();for(let e of this._virtualScenes)e._rebuildTextures()}_releaseRenderTargetWrapper(e){let t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)}get currentViewport(){return this._cachedViewport}setViewport(e,t,r){let i=t||this.getRenderWidth(),s=r||this.getRenderHeight(),n=e.x||0,a=e.y||0;this._cachedViewport=e,this._viewport(n*i,a*s,i*e.width,s*e.height)}createCanvasImage(){return document.createElement("img")}createCanvasPath2D(e){return new Path2D(e)}get description(){let e=this.name+this.version;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e}_createTextureBase(e,t,r,n,a=3,o=null,l=null,h,u,c=null,_=null,f=null,p=null,g,b,v){let x="data:"===(e=e||"").substr(0,5),y="blob:"===e.substr(0,5),S=x&&-1!==e.indexOf(";base64,"),w=_||new d.l(this,1);w!==_&&(w.label=e.substring(0,60));let F=e;!this._transformTextureUrl||S||_||c||(e=this._transformTextureUrl(e)),F!==e&&(w._originalUrl=F);let P=e.lastIndexOf("."),A=p||(P>-1?e.substring(P).toLowerCase():"");A.indexOf("?")>-1&&(A=A.split("?")[0]);let T=(0,m.qr)(A,g);n&&n.addPendingData(w),w.url=e,w.generateMipMaps=!t,w.samplingMode=a,w.invertY=r,w._useSRGBBuffer=this._getUseSRGBBuffer(!!v,t),this._doNotHandleContextLost||(w._buffer=c);let R=null;o&&!_&&(R=w.onLoadedObservable.add(o)),_||this._internalTexturesCache.push(w);let E=(r,_)=>{n&&n.removePendingData(w),e===F?(R&&w.onLoadedObservable.remove(R),i.l.UseFallbackTexture&&e!==i.l.FallbackTexture&&this._createTextureBase(i.l.FallbackTexture,t,w.invertY,n,a,null,l,h,u,c,w),r=(r||"Unknown error")+(i.l.UseFallbackTexture?" - Fallback texture was used":""),w.onErrorObservable.notifyObservers({message:r,exception:_}),l&&l(r,_)):(s.Y.Warn(`Failed to load ${e}, falling back to ${F}`),this._createTextureBase(F,t,w.invertY,n,a,o,l,h,u,c,w,f,p,g,b,v))};if(T){let t=async e=>{(await T).loadData(e,w,(e,t,r,i,s,o)=>{o?E("TextureLoader failed to load data"):h(w,A,n,{width:e,height:t},w.invertY,!r,i,()=>(s(),!1),a)},b)};c?c instanceof ArrayBuffer?t(new Uint8Array(c)):ArrayBuffer.isView(c)?t(c):l&&l("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(e,e=>t(new Uint8Array(e)),void 0,n?n.offlineProvider:void 0,!0,(e,t)=>{E("Unable to load "+(e&&e.responseURL,t))})}else{let r=e=>{y&&!this._doNotHandleContextLost&&(w._buffer=e),h(w,A,n,e,w.invertY,t,!1,u,a)};!x||S?c&&("string"==typeof c.decoding||c.close)?r(c):C._FileToolsLoadImage(e||"",r,E,n?n.offlineProvider:null,g,w.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):"string"==typeof c||c instanceof ArrayBuffer||ArrayBuffer.isView(c)||c instanceof Blob?C._FileToolsLoadImage(c,r,E,n?n.offlineProvider:null,g,w.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):c&&r(c)}return w}_rebuildBuffers(){for(let e of this._uniformBuffers)e._rebuildAfterContextLost()}get _shouldUseHighPrecisionShader(){return!!(this._caps.highPrecisionShaderSupported&&this._highPrecisionShadersAllowed)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:(0,f.n5)()?document:null}getLoadedTexturesCache(){return this._internalTexturesCache}clearInternalTexturesCache(){this._internalTexturesCache.length=0}getCaps(){return this._caps}resetTextureCache(){for(let e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1}get name(){return this._name}set name(e){this._name=e}static get NpmPackage(){return"babylonjs@8.4.0"}static get Version(){return"8.4.0"}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}setHardwareScalingLevel(e){this._hardwareScalingLevel=e,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(e){this._doNotHandleContextLost=e}get isStencilEnable(){return this._isStencilEnable}getCreationOptions(){return this._creationOptions}constructor(e,t,r){this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new l.k,this._stencilStateComposer=new h.C,this._stencilState=new u.s,this._alphaState=new c.Q,this._alphaMode=1,this._alphaEquation=0,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=[],this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new p.y$,this.onCanvasFocusObservable=new p.y$,this.onNewSceneAddedObservable=new p.y$,this.onResizeObservable=new p.y$,this.onCanvasPointerOutObservable=new p.y$,this.onEffectErrorObservable=new p.y$,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=0,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=[],this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=[],this.onBeforeTextureInitObservable=new p.y$,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=[],this._windowIsBackground=!1,this._boundRenderFunction=e=>this._renderLoop(e),this._lastFrameTime=0,this._renderAccumulator=0,this.skipFrameRender=!1,this.onBeforeShaderCompilationObservable=new p.y$,this.onAfterShaderCompilationObservable=new p.y$,this.onBeginFrameObservable=new p.y$,this.onEndFrameObservable=new p.y$,this._transformTextureUrl=null,this._uniformBuffers=[],this._storageBuffers=[],this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new p.y$,this.onContextRestoredObservable=new p.y$,this._name="",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=["main"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.onDisposeObservable=new p.y$,this.onReleaseEffectsObservable=new p.y$,i.l.Instances.push(this),this.startTime=o.F.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,a.Z.SetMatrixPrecision(!!t.useHighPrecisionMatrix),(0,f.up)()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=r??!1,t.antialias=e??t.antialias,t.deterministicLockstep=t.deterministicLockstep??!1,t.lockstepMaxSteps=t.lockstepMaxSteps??4,t.timeStep=t.timeStep??1/60,t.stencil=t.stencil??!0,this._audioContext=t.audioEngineOptions?.audioContext??null,this._audioDestination=t.audioEngineOptions?.audioDestination??null,this.premultipliedAlpha=t.premultipliedAlpha??!0,this._doNotHandleContextLost=!!t.doNotHandleContextLost,this._isStencilEnable=!!t.stencil,this.useExactSrgbConversions=t.useExactSrgbConversions??!1;let s=(0,f.CG)()&&window.devicePixelRatio||1,n=t.limitDeviceRatio||s;r=r||t.adaptToDeviceRatio||!1,this._hardwareScalingLevel=r?1/Math.min(n,s):1,this._lastDevicePixelRatio=s,this._creationOptions=t}resize(e=!1){let t,r;if(this.adaptToDeviceRatio){let e=(0,f.CG)()&&window.devicePixelRatio||1,t=this._lastDevicePixelRatio/e;this._lastDevicePixelRatio=e,this._hardwareScalingLevel*=t}if((0,f.CG)()&&(0,f.n5)())if(this._renderingCanvas){let e=this._renderingCanvas.getBoundingClientRect?.();t=this._renderingCanvas.clientWidth||e?.width||this._renderingCanvas.width*this._hardwareScalingLevel||100,r=this._renderingCanvas.clientHeight||e?.height||this._renderingCanvas.height*this._hardwareScalingLevel||100}else t=window.innerWidth,r=window.innerHeight;else t=this._renderingCanvas?this._renderingCanvas.width:100,r=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(t/this._hardwareScalingLevel,r/this._hardwareScalingLevel,e)}setSize(e,t,r=!1){if(!this._renderingCanvas||(e|=0,t|=0,!r&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t))return!1;if(this._renderingCanvas.width=e,this._renderingCanvas.height=t,this.scenes){for(let e=0;e<this.scenes.length;e++){let t=this.scenes[e];for(let e=0;e<t.cameras.length;e++)t.cameras[e]._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}createRawTexture(e,t,r,i,s,n,a,o,l,h,u){throw(0,_.S)("engine.rawTexture")}createRawCubeTexture(e,t,r,i,s,n,a,o){throw(0,_.S)("engine.rawTexture")}createRawTexture3D(e,t,r,i,s,n,a,o,l,h,u){throw(0,_.S)("engine.rawTexture")}createRawTexture2DArray(e,t,r,i,s,n,a,o,l,h,u){throw(0,_.S)("engine.rawTexture")}_sharedInit(e){this._renderingCanvas=e}_setupMobileChecks(){navigator&&navigator.userAgent&&(this._checkForMobile=()=>{let e=navigator.userAgent;this.hostInformation.isMobile=-1!==e.indexOf("Mobile")||-1!==e.indexOf("Mac")&&(0,f.n5)()&&"ontouchend"in document},this._checkForMobile(),(0,f.CG)()&&window.addEventListener("resize",this._checkForMobile))}createVideoElement(e){return document.createElement("video")}_reportDrawCall(e=1){this._drawCalls?.addCount(e,!1)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1e3*this._timeStep}_createImageBitmapFromSource(e,t){throw Error("createImageBitmapFromSource is not implemented")}createImageBitmap(e,t){return createImageBitmap(e,t)}resizeImageBitmap(e,t,r){throw Error("resizeImageBitmap is not implemented")}getFontOffset(e){throw Error("getFontOffset is not implemented")}static _CreateCanvas(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);let r=document.createElement("canvas");return r.width=e,r.height=t,r}createCanvas(e,t){return C._CreateCanvas(e,t)}static _FileToolsLoadImage(e,t,r,i,s,n,a){throw(0,_.S)("FileTools")}_loadFile(e,t,r,i,s,n){let a=(0,g.wv)(e,t,r,i,s,n);return this._activeRequests.push(a),a.onCompleteObservable.add(()=>{let e=this._activeRequests.indexOf(a);-1!==e&&this._activeRequests.splice(e,1)}),a}static _FileToolsLoadFile(e,t,r,i,s,n){if(g.an.loadFile)return g.an.loadFile(e,t,r,i,s,n);throw(0,_.S)("FileTools")}dispose(){for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();for(let e of(this.releaseComputeEffects?.(),n.Q.ResetCache(),this._activeRequests))e.abort();this._boundRenderFunction=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),this.onEffectErrorObservable.clear(),(0,f.CG)()&&window.removeEventListener("resize",this._checkForMobile);let e=i.l.Instances.indexOf(this);e>=0&&i.l.Instances.splice(e,1),i.l.Instances.length||(i.l.OnEnginesDisposedObservable.notifyObservers(this),i.l.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}static DefaultLoadingScreenFactory(e){throw(0,_.S)("LoadingScreen")}static MarkAllMaterialsAsDirty(e,t){for(let r=0;r<i.l.Instances.length;r++){let s=i.l.Instances[r];for(let r=0;r<s.scenes.length;r++)s.scenes[r].markAllMaterialsAsDirty(e,t)}}}C._RenderPassIdCounter=0,C._RescalePostProcessFactory=null,C.CollisionsEpsilon=.001,C.QueueNewFrame=b},66395:function(e,t,r){r.d(t,{l:()=>s});var i=r(67791);class s{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}s.Instances=[],s.OnEnginesDisposedObservable=new i.y$,s._LastCreatedScene=null,s.UseFallbackTexture=!0,s.FallbackTexture=""},77783:function(e,t,r){r.d(t,{Z:()=>i});class i{static SetMatrixPrecision(e){if(i.MatrixTrackPrecisionChange=!1,e&&!i.MatrixUse64Bits&&i.MatrixTrackedMatrices)for(let e=0;e<i.MatrixTrackedMatrices.length;++e){let t=i.MatrixTrackedMatrices[e],r=t._m;t._m=Array(16);for(let e=0;e<16;++e)t._m[e]=r[e]}i.MatrixUse64Bits=e,i.MatrixCurrentType=i.MatrixUse64Bits?Array:Float32Array,i.MatrixTrackedMatrices=null}}i.MatrixUse64Bits=!1,i.MatrixTrackPrecisionChange=!0,i.MatrixCurrentType=Float32Array,i.MatrixTrackedMatrices=[]},80709:function(e,t,r){r.d(t,{v:()=>i});class i{static GetShadersRepository(e=0){return 0===e?i.ShadersRepository:i.ShadersRepositoryWGSL}static GetShadersStore(e=0){return 0===e?i.ShadersStore:i.ShadersStoreWGSL}static GetIncludesShadersStore(e=0){return 0===e?i.IncludesShadersStore:i.IncludesShadersStoreWGSL}}i.ShadersRepository="src/Shaders/",i.ShadersStore={},i.IncludesShadersStore={},i.ShadersRepositoryWGSL="src/ShadersWGSL/",i.ShadersStoreWGSL={},i.IncludesShadersStoreWGSL={}},10328:function(e,t,r){r.d(t,{AM:()=>h,H6:()=>c,HN:()=>f,KG:()=>p,PR:()=>C,Q:()=>b,gt:()=>d,iU:()=>o,s5:()=>_,tQ:()=>u,tY:()=>l});var i=r(3199),s=r(88173);let n=new WeakMap,a={_webGLVersion:2,cachedPipelines:{}};function o(e){let t=n.get(e);if(!t){if(!e)return a;t={_webGLVersion:e.TEXTURE_BINDING_3D?2:1,_context:e,parallelShaderCompile:e.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},n.set(e,t)}return t}function l(e){n.delete(e)}function h(e,t,r,i,s,n){let a=o(i);return n||(n=a._createShaderProgramInjection??_),n(e,m(t,"vertex",i,a._contextWasLost),m(r,"fragment",i,a._contextWasLost),i,s,a.validateShaderPrograms)}function u(e,t,r,i,s,n=null,a){let l=o(s);a||(a=l._createShaderProgramInjection??_);let h=l._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return a(e,g(t,"vertex",i,h,s,l._contextWasLost),g(r,"fragment",i,h,s,l._contextWasLost),s,n,l.validateShaderPrograms)}function c(e,t){let r=new i.y,s=o(e);return s.parallelShaderCompile&&!s.disableParallelShaderCompile&&(r.isParallelCompiled=!0),r.context=s._context,r}function _(e,t,r,i,s=null,n){let a=i.createProgram();if(e.program=a,!a)throw Error("Unable to create program");return i.attachShader(a,t),i.attachShader(a,r),i.linkProgram(a),e.context=i,e.vertexShader=t,e.fragmentShader=r,e.isParallelCompiled||f(e,i,n),a}function d(e,t,r){if(e._isDisposed)return!1;let i=o(t);return!!(i&&i.parallelShaderCompile&&i.parallelShaderCompile.COMPLETION_STATUS_KHR&&e.program&&t.getProgramParameter(e.program,i.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(f(e,t,r),!0)}function f(e,t,r){let i=e.context,s=e.vertexShader,n=e.fragmentShader,a=e.program;if(!i.getProgramParameter(a,i.LINK_STATUS)){if(!t.getShaderParameter(s,t.COMPILE_STATUS)){let r=t.getShaderInfoLog(s);if(r)throw e.vertexCompilationError=r,Error("VERTEX SHADER "+r)}if(!t.getShaderParameter(n,t.COMPILE_STATUS)){let r=t.getShaderInfoLog(n);if(r)throw e.fragmentCompilationError=r,Error("FRAGMENT SHADER "+r)}let r=i.getProgramInfoLog(a);if(r)throw e.programLinkError=r,Error(r)}if(r&&(i.validateProgram(a),!i.getProgramParameter(a,i.VALIDATE_STATUS))){let t=i.getProgramInfoLog(a);if(t)throw e.programValidationError=t,Error(t)}i.deleteShader(s),i.deleteShader(n),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}function p(e,t,r,i,s,n,a,l,c,_="",d,f,g){let m=o(e.context);f||(f=m.createRawShaderProgramInjection??h),g||(g=m.createShaderProgramInjection??u),i?e.program=f(e,t,r,e.context,c):e.program=g(e,t,r,l,e.context,c),e.program.__SPECTOR_rebuildProgram=a,d()}function g(e,t,r,i,n,a){return m((0,s.Gb)(e,r,i),t,n,a)}function m(e,t,r,i){let s=r.createShader("vertex"===t?r.VERTEX_SHADER:r.FRAGMENT_SHADER);if(!s){let e=r.NO_ERROR,s=r.NO_ERROR;for(;(s=r.getError())!==r.NO_ERROR;)e=s;throw Error(`Something went wrong while creating a gl ${t} shader object. gl error=${e}, gl isContextLost=${r.isContextLost()}, _contextWasLost=${i}`)}return r.shaderSource(s,e),r.compileShader(s),s}function b(e,t){t.useProgram(e)}function C(e,t){if(!e.isParallelCompiled)return void t(e);let r=e.onCompiled;e.onCompiled=()=>{r?.(),t(e)}}},47816:function(e,t,r){r.d(t,{ql:()=>n,qr:()=>o,rY:()=>a});var i=r(92550);let s=new Map;function n(e,t){a(e)&&i.Y.Warn(`Extension with the name '${name}' already exists`),s.set(e,t)}function a(e){return s.delete(e)}function o(e,t){("image/ktx"===t||"image/ktx2"===t)&&(e=".ktx"),!s.has(e)&&(e.endsWith(".ies")&&n(".ies",()=>r.e("1863").then(r.bind(r,79437)).then(e=>new e._IESTextureLoader)),e.endsWith(".dds")&&n(".dds",()=>Promise.all([r.e("8146"),r.e("2343"),r.e("7753"),r.e("754"),r.e("4269")]).then(r.bind(r,94267)).then(e=>new e._DDSTextureLoader)),e.endsWith(".basis")&&n(".basis",()=>Promise.all([r.e("8146"),r.e("2343"),r.e("4034")]).then(r.bind(r,4302)).then(e=>new e._BasisTextureLoader)),e.endsWith(".env")&&n(".env",()=>Promise.all([r.e("8146"),r.e("2343"),r.e("7753"),r.e("6666")]).then(r.bind(r,38378)).then(e=>new e._ENVTextureLoader)),e.endsWith(".hdr")&&n(".hdr",()=>Promise.all([r.e("8146"),r.e("8550")]).then(r.bind(r,46259)).then(e=>new e._HDRTextureLoader)),(e.endsWith(".ktx")||e.endsWith(".ktx2"))&&(n(".ktx",()=>r.e("3480").then(r.bind(r,44197)).then(e=>new e._KTXTextureLoader)),n(".ktx2",()=>r.e("3480").then(r.bind(r,44197)).then(e=>new e._KTXTextureLoader))),e.endsWith(".tga")&&n(".tga",()=>r.e("1326").then(r.bind(r,50133)).then(e=>new e._TGATextureLoader)),e.endsWith(".exr")&&n(".exr",()=>r.e("5650").then(r.bind(r,13380)).then(e=>new e._ExrTextureLoader)));let i=s.get(e);return i?Promise.resolve(i(t)):null}},10967:function(e,t,r){r.d(t,{S:()=>s,l:()=>o});var i,s,n=r(67791),a=r(98891);(i=s||(s={}))[i.Unknown=0]="Unknown",i[i.Url=1]="Url",i[i.Temp=2]="Temp",i[i.Raw=3]="Raw",i[i.Dynamic=4]="Dynamic",i[i.RenderTarget=5]="RenderTarget",i[i.MultiRenderTarget=6]="MultiRenderTarget",i[i.Cube=7]="Cube",i[i.CubeRaw=8]="CubeRaw",i[i.CubePrefiltered=9]="CubePrefiltered",i[i.Raw3D=10]="Raw3D",i[i.Raw2DArray=11]="Raw2DArray",i[i.DepthStencil=12]="DepthStencil",i[i.CubeRawRGBD=13]="CubeRawRGBD",i[i.Depth=14]="Depth";class o extends a.a{get useMipMaps(){return this.generateMipMaps}set useMipMaps(e){this.generateMipMaps=e}get uniqueId(){return this._uniqueId}_setUniqueId(e){this._uniqueId=e}getEngine(){return this._engine}get source(){return this._source}constructor(e,t,r=!1){super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new n.y$,this.onErrorObservable=new n.y$,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=0,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._creationFlags=0,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._premulAlpha=!1,this._dynamicTextureSource=null,this._autoMSAAManagement=!1,this._engine=e,this._source=t,this._uniqueId=o._Counter++,r||(this._hardwareTexture=e._createHardwareTexture())}incrementReferences(){this._references++}updateSize(e,t,r=1){this._engine.updateTextureDimensions(this,e,t,r),this.width=e,this.height=t,this.depth=r,this.baseWidth=e,this.baseHeight=t,this.baseDepth=r,this._size=e*t*r}_rebuild(){let e;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){let e=this.onRebuildCallback(this),t=t=>{t._swapAndDie(this,!1),this.isReady=e.isReady};e.isAsync?e.proxy.then(t):t(e.proxy);return}switch(this.source){case 2:break;case 1:e=this._engine.createTexture(this._originalUrl??this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,e=>{e._swapAndDie(this,!1),this.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer);return;case 3:(e=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer))._swapAndDie(this,!1),this.isReady=!0;break;case 10:(e=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case 11:(e=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case 4:(e=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case 7:e=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,()=>{e._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null);return;case 8:(e=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this._originalFormat??this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1),this.isReady=!0;break;case 13:return;case 9:(e=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,e=>{e&&e._swapAndDie(this,!1),this.isReady=!0},null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial;return}}_swapAndDie(e,t=!0){this._hardwareTexture?.setUsage(e._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);let r=this._engine.getLoadedTexturesCache(),i=r.indexOf(this);-1!==i&&r.splice(i,1),-1===(i=r.indexOf(e))&&r.push(e)}dispose(){this._references--,0===this._references&&(this.onLoadedObservable.clear(),this.onErrorObservable.clear(),this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}}o._Counter=0},98891:function(e,t,r){r.d(t,{a:()=>i});class i{get wrapU(){return this._cachedWrapU}set wrapU(e){this._cachedWrapU=e}get wrapV(){return this._cachedWrapV}set wrapV(e){this._cachedWrapV=e}get wrapR(){return this._cachedWrapR}set wrapR(e){this._cachedWrapR=e}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(e){this._cachedAnisotropicFilteringLevel=e}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(e){this._comparisonFunction=e}get useMipMaps(){return this._useMipMaps}set useMipMaps(e){this._useMipMaps=e}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}setParameters(e=1,t=1,r=1,i=1,s=2,n=0){return this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=r,this._cachedAnisotropicFilteringLevel=i,this.samplingMode=s,this._comparisonFunction=n,this}compareSampler(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps}}},18944:function(e,t,r){r.d(t,{Z9:()=>c,ZI:()=>u,dR:()=>h,sp:()=>d});var i=r(82090),s=r(10328),n=r(80709),a=r(92550),o=r(67552),l=r(88173);function h(e,t){return(0,s.iU)(t).cachedPipelines[e]}function u(e){let t=e._name,r=e.context;if(t&&r){let e=(0,s.iU)(r),i=e.cachedPipelines[t];i?.dispose(),delete e.cachedPipelines[t]}}function c(e,t,r,s,n,a,l){let h,u,c=(0,i.CG)()?a?.getHostDocument():null;h="string"==typeof t?t:t.vertexSource?"source:"+t.vertexSource:t.vertexElement?c?.getElementById(t.vertexElement)||t.vertexElement:t.vertex||t,u="string"==typeof t?t:t.fragmentSource?"source:"+t.fragmentSource:t.fragmentElement?c?.getElementById(t.fragmentElement)||t.fragmentElement:t.fragment||t;let d=[void 0,void 0],f=()=>{if(d[0]&&d[1]){e.isFragment=!0;let[i,h]=d;(0,o.An)(h,e,(a,h)=>{var u,c,_,d;l&&(l._fragmentSourceCodeBeforeMigration=h),r&&(a=r("fragment",a));let f=(0,o.Ku)(i,a,e);e=null;let p=(u=f.vertexCode,c=f.fragmentCode,_=t,d=n,_?{vertexSourceCode:(1===d?"//":"")+"#define SHADER_NAME vertex:"+(_.vertexElement||_.vertex||_.spectorName||_)+"\n"+u,fragmentSourceCode:(1===d?"//":"")+"#define SHADER_NAME fragment:"+(_.fragmentElement||_.fragment||_.spectorName||_)+"\n"+c}:{vertexSourceCode:u,fragmentSourceCode:c});s?.(p.vertexSourceCode,p.fragmentSourceCode)},a)}};_(h,"Vertex","",t=>{(0,o.wz)(e),(0,o.An)(t,e,(e,i)=>{l&&(l._rawVertexSourceCode=t,l._vertexSourceCodeBeforeMigration=i),r&&(e=r("vertex",e)),d[0]=e,f()},a)},n),_(u,"Fragment","Pixel",e=>{l&&(l._rawFragmentSourceCode=e),d[1]=e,f()},n)}function _(e,t,r,s,a,o){let h;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return void s((0,i.v)(e));if("source:"===e.substring(0,7))return void s(e.substring(7));if("base64:"===e.substring(0,7))return void s(window.atob(e.substring(7)));let u=n.v.GetShadersStore(a);if(u[e+t+"Shader"])return void s(u[e+t+"Shader"]);if(r&&u[e+r+"Shader"])return void s(u[e+r+"Shader"]);if(h="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:n.v.GetShadersRepository(a)+e,!(o=o||l.wv))throw Error("loadFileInjection is not defined");o(h+"."+t.toLowerCase()+".fx",s)}let d=(e,t,r,i)=>{try{let n=e.context?(0,s.iU)(e.context):null;n&&(n.disableParallelShaderCompile=e.disableParallelCompilation);let a=e.existingPipelineContext||t(e.shaderProcessingContext);return a._name=e.name,e.name&&n&&(n.cachedPipelines[e.name]=a),r(a,e.vertex,e.fragment,!!e.createAsRaw,"","",e.rebuildRebind,e.defines,e.transformFeedbackVaryings,"",()=>{i(a,()=>{e.onRenderingStateCompiled?.(a)})}),a}catch(e){throw a.Y.Error("Error compiling effect"),e}}},21389:function(e,t,r){r.d(t,{Q:()=>l});var i=r(67791),s=r(92550),n=r(80709),a=r(18944),o=r(28118);class l{static get ShadersRepository(){return n.v.ShadersRepository}static set ShadersRepository(e){n.v.ShadersRepository=e}get isDisposed(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new i.y$),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(e,t,r,s=null,n,o=null,h=null,u=null,c=null,_,d="",f=0,p){let g;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new i.y$,this.onErrorObservable=new i.y$,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=e,this._key=d;let m=this._key.replace(/\r/g,"").replace(/\n/g,"|");if(t.attributes){if(this._engine=r,this._attributesNames=t.attributes,this._uniformsNames=t.uniformsNames.concat(t.samplers),this._samplerList=t.samplers.slice(),this.defines=t.defines,this.onError=t.onError,this.onCompiled=t.onCompiled,this._fallbacks=t.fallbacks,this._indexParameters=t.indexParameters,this._transformFeedbackVaryings=t.transformFeedbackVaryings||null,this._multiTarget=!!t.multiTarget,this._shaderLanguage=t.shaderLanguage??0,this._disableParallelShaderCompilation=!!t.disableParallelShaderCompilation,t.uniformBuffersNames){this._uniformBuffersNamesList=t.uniformBuffersNames.slice();for(let e=0;e<t.uniformBuffersNames.length;e++)this._uniformBuffersNames[t.uniformBuffersNames[e]]=e}this._processFinalCode=t.processFinalCode??null,this._processCodeAfterIncludes=t.processCodeAfterIncludes??void 0,p=t.extraInitializationsAsync,g=t.existingPipelineContext}else this._engine=n,this.defines=null==o?"":o,this._uniformsNames=r.concat(s),this._samplerList=s?s.slice():[],this._attributesNames=t,this._uniformBuffersNamesList=[],this._shaderLanguage=f,this.onError=c,this.onCompiled=u,this._indexParameters=_,this._fallbacks=h;"WEBGL2"===this._engine.shaderPlatformName&&(g=(0,a.dR)(m,this._engine._gl)??g),this._attributeLocationByName={},this.uniqueId=l._UniqueIdSeed++,g?(this._pipelineContext=g,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,p),this._engine.onReleaseEffectsObservable.addOnce(()=>{this.isDisposed||this.dispose(!0)})}async _processShaderCodeAsync(e=null,t=!1,r=null,i){i&&await i(),this._processingContext=r||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);let s={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:e??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:n.v.GetShadersRepository(this._shaderLanguage),includesShadersStore:n.v.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,a.Z9)(s,this.name,this._processFinalCode,(e,r)=>{this._vertexSourceCode=e,this._fragmentSourceCode=r,this._prepareEffect(t)},this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.isDisposed||!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(e){return this._attributes[e]}getAttributeLocationByName(e){return this._attributeLocationByName[e]}getAttributesCount(){return this._attributes.length}getUniformIndex(e){return this._uniformsNames.indexOf(e)}getUniform(e){return this._uniforms[e]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}whenCompiledAsync(){return new Promise(e=>{this.executeWhenCompiled(e)})}executeWhenCompiled(e){if(this.isReady())return void e(this);this.onCompileObservable.add(t=>{e(t)}),(!this._pipelineContext||this._pipelineContext.isAsync)&&this._checkIsReady(null)}_checkIsReady(e){(0,o.r)(()=>this._isReadyInternal()||this._isDisposed,()=>{},t=>{this._processCompilationErrors(t,e)},16,12e4,!0,` - Effect: ${"string"==typeof this.name?this.name:this.key}`)}get vertexSourceCode(){return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:this._pipelineContext?._getVertexShaderCode()??this._vertexSourceCode}get fragmentSourceCode(){return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:this._pipelineContext?._getFragmentShaderCode()??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!!(this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride)}}}_rebuildProgram(e,t,r,i){this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=(e,t)=>{i&&i(t)},this.onCompiled=()=>{let e=this.getEngine().scenes;if(e)for(let t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(127);this._pipelineContext._handlesSpectorRebuildCallback?.(r)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(e){if(this._pipelineContext=e,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let e=0;e<this._attributesNames.length;e++){let t=this._attributesNames[e];this._attributeLocationByName[t]=this._attributes[e]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),l.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(e=!1){let t=this._pipelineContext;this._isReady=!1;try{let r=!!(this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride),i=r?null:this.defines,s=r?this._vertexSourceCodeOverride:this._vertexSourceCode,n=r?this._fragmentSourceCodeOverride:this._fragmentSourceCode,o=this._engine;this._pipelineContext=(0,a.sp)({existingPipelineContext:e?t:null,vertex:s,fragment:n,context:"WEBGL2"===o.shaderPlatformName||"WEBGL1"===o.shaderPlatformName?o._gl:void 0,rebuildRebind:(e,t,r,i)=>this._rebuildProgram(e,t,r,i),defines:i,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:r,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:r=>{t&&!e&&this._engine._deletePipelineContext(t),r&&this._onRenderingStateCompiled(r)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContext.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(t)}catch(e){this._processCompilationErrors(e,t)}}_getShaderCodeAndErrorLine(e,t,r){let i=null;if(t&&e){let s=t.match(r?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/);if(s&&2===s.length){let t=parseInt(s[1]),n=e.split("\n",-1);n.length>=t&&(i=`Offending line [${t}] in ${r?"fragment":"vertex"} code: ${n[t-1]}`)}}return[e,i]}_processCompilationErrors(e,t=null){this._compilationError=e.message;let r=this._attributesNames,i=this._fallbacks;if(s.Y.Error("Unable to compile effect:"),s.Y.Error("Uniforms: "+this._uniformsNames.map(function(e){return" "+e})),s.Y.Error("Attributes: "+r.map(function(e){return" "+e})),s.Y.Error("Defines:\n"+this.defines),l.LogShaderCodeOnCompilationError){let e=null,t=null,r=null;this._pipelineContext?._getVertexShaderCode()&&([r,e]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),r&&(s.Y.Error("Vertex code:"),s.Y.Error(r))),this._pipelineContext?._getFragmentShaderCode()&&([r,t]=this._getShaderCodeAndErrorLine(this._pipelineContext?._getFragmentShaderCode(),this._compilationError,!0),r&&(s.Y.Error("Fragment code:"),s.Y.Error(r))),e&&s.Y.Error(e),t&&s.Y.Error(t)}s.Y.Error("Error: "+this._compilationError);let n=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};t&&(this._pipelineContext=t,this._isReady=!0,n()),i?(this._pipelineContext=null,i.hasMoreFallbacks?(this._allFallbacksProcessed=!1,s.Y.Error("Trying next fallback."),this.defines=i.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,n(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,t||n())}get isSupported(){return""===this._compilationError}_bindTexture(e,t){this._engine._bindTexture(this._samplers[e],t,e)}setTexture(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)}setTextureArray(e,t){let r=e+"Ex";if(-1===this._samplerList.indexOf(r+"0")){let i=this._samplerList.indexOf(e);for(let e=1;e<t.length;e++){let t=r+(e-1).toString();this._samplerList.splice(i+e,0,t)}let s=0;for(let e of this._samplerList)this._samplers[e]=s,s+=1}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)}bindUniformBuffer(e,t){let r=this._uniformBuffersNames[t];void 0===r||l._BaseCache[r]===e&&this._engine._features.useUBOBindingCache||(l._BaseCache[r]=e,this._engine.bindUniformBufferBase(e,r,t))}bindUniformBlock(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)}setInt(e,t){return this._pipelineContext.setInt(e,t),this}setInt2(e,t,r){return this._pipelineContext.setInt2(e,t,r),this}setInt3(e,t,r,i){return this._pipelineContext.setInt3(e,t,r,i),this}setInt4(e,t,r,i,s){return this._pipelineContext.setInt4(e,t,r,i,s),this}setIntArray(e,t){return this._pipelineContext.setIntArray(e,t),this}setIntArray2(e,t){return this._pipelineContext.setIntArray2(e,t),this}setIntArray3(e,t){return this._pipelineContext.setIntArray3(e,t),this}setIntArray4(e,t){return this._pipelineContext.setIntArray4(e,t),this}setUInt(e,t){return this._pipelineContext.setUInt(e,t),this}setUInt2(e,t,r){return this._pipelineContext.setUInt2(e,t,r),this}setUInt3(e,t,r,i){return this._pipelineContext.setUInt3(e,t,r,i),this}setUInt4(e,t,r,i,s){return this._pipelineContext.setUInt4(e,t,r,i,s),this}setUIntArray(e,t){return this._pipelineContext.setUIntArray(e,t),this}setUIntArray2(e,t){return this._pipelineContext.setUIntArray2(e,t),this}setUIntArray3(e,t){return this._pipelineContext.setUIntArray3(e,t),this}setUIntArray4(e,t){return this._pipelineContext.setUIntArray4(e,t),this}setFloatArray(e,t){return this._pipelineContext.setArray(e,t),this}setFloatArray2(e,t){return this._pipelineContext.setArray2(e,t),this}setFloatArray3(e,t){return this._pipelineContext.setArray3(e,t),this}setFloatArray4(e,t){return this._pipelineContext.setArray4(e,t),this}setArray(e,t){return this._pipelineContext.setArray(e,t),this}setArray2(e,t){return this._pipelineContext.setArray2(e,t),this}setArray3(e,t){return this._pipelineContext.setArray3(e,t),this}setArray4(e,t){return this._pipelineContext.setArray4(e,t),this}setMatrices(e,t){return this._pipelineContext.setMatrices(e,t),this}setMatrix(e,t){return this._pipelineContext.setMatrix(e,t),this}setMatrix3x3(e,t){return this._pipelineContext.setMatrix3x3(e,t),this}setMatrix2x2(e,t){return this._pipelineContext.setMatrix2x2(e,t),this}setFloat(e,t){return this._pipelineContext.setFloat(e,t),this}setBool(e,t){return this._pipelineContext.setInt(e,+!!t),this}setVector2(e,t){return this._pipelineContext.setVector2(e,t),this}setFloat2(e,t,r){return this._pipelineContext.setFloat2(e,t,r),this}setVector3(e,t){return this._pipelineContext.setVector3(e,t),this}setFloat3(e,t,r,i){return this._pipelineContext.setFloat3(e,t,r,i),this}setVector4(e,t){return this._pipelineContext.setVector4(e,t),this}setQuaternion(e,t){return this._pipelineContext.setQuaternion(e,t),this}setFloat4(e,t,r,i,s){return this._pipelineContext.setFloat4(e,t,r,i,s),this}setColor3(e,t){return this._pipelineContext.setColor3(e,t),this}setColor4(e,t,r){return this._pipelineContext.setColor4(e,t,r),this}setDirectColor4(e,t){return this._pipelineContext.setDirectColor4(e,t),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(e=!1){if(e)this._refCount=0;else{if(l.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,a.ZI)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(e,t,r,i=0){t&&(n.v.GetShadersStore(i)[`${e}PixelShader`]=t),r&&(n.v.GetShadersStore(i)[`${e}VertexShader`]=r)}static ResetCache(){l._BaseCache={}}}l.LogShaderCodeOnCompilationError=!0,l.PersistentMode=!1,l.AutomaticallyClearCodeCache=!1,l._UniqueIdSeed=0,l._BaseCache={},l.ShadersStore=n.v.ShadersStore,l.IncludesShadersStore=n.v.IncludesShadersStore},7375:function(e,t,r){r.d(t,{j:()=>n});var i=r(92550);let s=(e,t,r)=>!e||e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&("SubMesh"===e.getClassName()||"PhysicsBody"===e.getClassName())?e.clone(t):e.clone?e.clone():Array.isArray(e)?e.slice():r&&"object"==typeof e?{...e}:null;class n{static DeepCopy(e,t,r,n,a=!1){for(let o of function(e){let t=[];do for(let r of Object.getOwnPropertyNames(e))-1===t.indexOf(r)&&t.push(r);while(e=Object.getPrototypeOf(e));return t}(e)){if("_"===o[0]&&(!n||-1===n.indexOf(o))||o.endsWith("Observable")||r&&-1!==r.indexOf(o))continue;let l=e[o],h=typeof l;if("function"!==h)try{if("object"===h)if(l instanceof Uint8Array)t[o]=Uint8Array.from(l);else if(l instanceof Array){if(t[o]=[],l.length>0)if("object"==typeof l[0])for(let e=0;e<l.length;e++){let r=s(l[e],t,a);-1===t[o].indexOf(r)&&t[o].push(r)}else t[o]=l.slice(0)}else t[o]=s(l,t,a);else t[o]=l}catch(e){i.Y.Warn(e.message)}}}}},9139:function(e,t,r){r.d(t,{S:()=>s});let i={};function s(e,t=!1){if(!t||!i[e])return i[e]=!0,`${e} needs to be imported before as it contains a side-effect required by your code.`}},82090:function(e,t,r){function i(){return"undefined"!=typeof window}function s(){return"undefined"!=typeof navigator}function n(){return"undefined"!=typeof document}function a(e){let t="",r=e.firstChild;for(;r;)3===r.nodeType&&(t+=r.textContent),r=r.nextSibling;return t}r.d(t,{CG:()=>i,MZ:()=>o,n5:()=>n,up:()=>s,v:()=>a});let o={IsWindowObjectExist:i,IsNavigatorAvailable:s,IsDocumentAvailable:n,GetDOMTextContent:a}},33116:function(e,t,r){r.d(t,{GU:()=>i,LH:()=>n,SM:()=>s,_L:()=>a});class i extends Error{}i._setPrototypeOf=Object.setPrototypeOf||((e,t)=>(e.__proto__=t,e));let s={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class n extends i{constructor(e,t,r){super(e),this.errorCode=t,this.innerError=r,this.name="RuntimeError",i._setPrototypeOf(this,n.prototype)}}class a extends i{constructor(e="Operation aborted"){super(e),this.name="AbortError",i._setPrototypeOf(this,a.prototype)}}},91336:function(e,t,r){let i;r.d(t,{$K:()=>U,$M:()=>y,A2:()=>D,FV:()=>A,Ip:()=>F,L7:()=>S,RC:()=>v,TU:()=>T,Uh:()=>R,VL:()=>E,W5:()=>B,e0:()=>i,eh:()=>b,kK:()=>C,qC:()=>L,r6:()=>w,rN:()=>x,vP:()=>P});var s=r(35011),n=r(82090),a=r(67791),o=r(75916),l=r(32601),h=r(33116),u=r(3533),c=r(67552),_=r(66395),d=r(92550),f=r(28118),p=r(88173),g=r(37384);let m=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class b extends h.LH{constructor(e,t){super(e,h.SM.LoadFileError),this.name="LoadFileError",h.GU._setPrototypeOf(this,b.prototype),t instanceof s.g?this.request=t:this.file=t}}class C extends h.LH{constructor(e,t){super(e,h.SM.RequestFileError),this.request=t,this.name="RequestFileError",h.GU._setPrototypeOf(this,C.prototype)}}class v extends h.LH{constructor(e,t){super(e,h.SM.ReadFileError),this.file=t,this.name="ReadFileError",h.GU._setPrototypeOf(this,v.prototype)}}let x={DefaultRetryStrategy:l.b.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:e=>e,ScriptBaseUrl:"",ScriptPreprocessUrl:e=>e,CleanUrl:e=>e=e.replace(/#/gm,"%23")},y=(e,t)=>{if((!e||0!==e.indexOf("data:"))&&x.CorsBehavior)if("string"==typeof x.CorsBehavior||x.CorsBehavior instanceof String)t.crossOrigin=x.CorsBehavior;else{let r=x.CorsBehavior(e);r&&(t.crossOrigin=r)}},S={getRequiredSize:null},w=(e,t,r,i,n="",a,l=_.l.LastCreatedEngine)=>{let h;if("undefined"==typeof HTMLImageElement&&!l?._features.forceBitmapOverHTMLImageElement)return r("LoadImage is only supported in web or BabylonNative environments."),null;let c=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob&&"undefined"!=typeof URL?(h=URL.createObjectURL(new Blob([e],{type:n})),c=!0):h=`data:${n};base64,`+(0,u.Gh)(e):e instanceof Blob?(h=URL.createObjectURL(e),c=!0):(h=x.CleanUrl(e),h=x.PreprocessUrl(h));let d=t=>{if(r){let i=h||e.toString();r(`Error while trying to load image: ${0===i.indexOf("http")||i.length<=128?i:i.slice(0,128)+"..."}`,t)}};if(l?._features.forceBitmapOverHTMLImageElement)return P(h,i=>{l.createImageBitmap(new Blob([i],{type:n}),{premultiplyAlpha:"none",...a}).then(e=>{t(e),c&&URL.revokeObjectURL(h)}).catch(t=>{r&&r("Error while trying to load image: "+e,t)})},void 0,i||void 0,!0,(e,t)=>{d(t)}),null;let f=new Image;if(S.getRequiredSize){let t=S.getRequiredSize(e);t.width&&(f.width=t.width),t.height&&(f.height=t.height)}y(h,f);let p=[],g=()=>{for(let e of p)e.target.removeEventListener(e.name,e.handler);p.length=0};for(let e of(p.push({target:f,name:"load",handler:()=>{g(),t(f),c&&f.src&&URL.revokeObjectURL(f.src)}}),p.push({target:f,name:"error",handler:e=>{g(),d(e),c&&f.src&&URL.revokeObjectURL(f.src)}}),p.push({target:document,name:"securitypolicyviolation",handler:e=>{if(e.blockedURI!==f.src||"report"===e.disposition)return;g();let t=Error(`CSP violation of policy ${e.effectiveDirective} ${e.blockedURI}. Current policy is ${e.originalPolicy}`);_.l.UseFallbackTexture=!1,d(t),c&&f.src&&URL.revokeObjectURL(f.src),f.src=""}}),p))e.target.addEventListener(e.name,e.handler);let m="blob:"===h.substring(0,5),b="data:"===h.substring(0,5),C=()=>{m||b||!s.g.IsCustomRequestAvailable?f.src=h:P(h,(e,t,r)=>{let i=new Blob([e],{type:!n&&r?r:n}),s=URL.createObjectURL(i);c=!0,f.src=s},void 0,i||void 0,!0,(e,t)=>{d(t)})};if(!m&&!b&&i&&i.enableTexturesOffline)i.open(()=>{i&&i.loadImage(h,f)},C);else{if(-1!==h.indexOf("file:")){let e=decodeURIComponent(h.substring(5).toLowerCase());if(o.X.FilesToLoad[e]&&"undefined"!=typeof URL){try{let t;try{t=URL.createObjectURL(o.X.FilesToLoad[e])}catch(r){t=URL.createObjectURL(o.X.FilesToLoad[e])}f.src=t,c=!0}catch(e){f.src=""}return f}}C()}return f},F=(e,t,r,i,s)=>{let n=new FileReader,o={onCompleteObservable:new a.y$,abort:()=>n.abort()};return n.onloadend=()=>o.onCompleteObservable.notifyObservers(o),s&&(n.onerror=()=>{s(new v(`Unable to read ${e.name}`,e))}),n.onload=e=>{t(e.target.result)},r&&(n.onprogress=r),i?n.readAsArrayBuffer(e):n.readAsText(e),o},P=(e,t,r,i,s,n,l)=>{if(e.name)return F(e,t,r,s,n?e=>{n(void 0,e)}:void 0);if(-1!==e.indexOf("file:")){let i=decodeURIComponent(e.substring(5).toLowerCase());0===i.indexOf("./")&&(i=i.substring(2));let a=o.X.FilesToLoad[i];if(a)return F(a,t,r,s,n?e=>n(void 0,new b(e.message,e.file)):void 0)}let{match:h,type:u}=L(e);if(h){let r={onCompleteObservable:new a.y$,abort:()=>()=>{}};try{let r=s?U(e):D(e);t(r,void 0,u)}catch(e){n?n(void 0,e):d.Y.Error(e.message||"Failed to parse the Data URL")}return f.Q.SetImmediate(()=>{r.onCompleteObservable.notifyObservers(r)}),r}return A(e,(e,r)=>{t(e,r?.responseURL,r?.getResponseHeader("content-type"))},r,i,s,n?e=>{n(e.request,new b(e.message,e.request))}:void 0,l)},A=(e,t,r,i,o,l,h)=>{e=x.CleanUrl(e),e=x.PreprocessUrl(e);let u=x.BaseUrl+e,c=!1,_={onCompleteObservable:new a.y$,abort:()=>c=!0},f=()=>{let e,i=new s.g,a=null,f=()=>{i&&(r&&i.removeEventListener("progress",r),e&&i.removeEventListener("readystatechange",e),i.removeEventListener("loadend",p))},p=()=>{f(),_.onCompleteObservable.notifyObservers(_),_.onCompleteObservable.clear(),r=void 0,e=null,p=null,l=void 0,h=void 0,t=void 0};_.abort=()=>{c=!0,p&&p(),i&&i.readyState!==(XMLHttpRequest.DONE||4)&&i.abort(),null!==a&&(clearTimeout(a),a=null),i=null};let g=e=>{let t=e.message||"Unknown error";l&&i?l(new C(t,i)):d.Y.Error(t)},m=_=>{if(i){if(i.open("GET",u),h)try{h(i)}catch(e){g(e);return}o&&(i.responseType="arraybuffer"),r&&i.addEventListener("progress",r),p&&i.addEventListener("loadend",p),e=()=>{if(!c&&i&&i.readyState===(XMLHttpRequest.DONE||4)){if(e&&i.removeEventListener("readystatechange",e),i.status>=200&&i.status<300||0===i.status&&(!(0,n.CG)()||R())){let e=o?i.response:i.responseText;if(null!==e){try{t&&t(e,i)}catch(e){g(e)}return}}let r=x.DefaultRetryStrategy;if(r){let e=r(u,i,_);if(-1!==e){f(),i=new s.g,a=setTimeout(()=>m(_+1),e);return}}let h=new C("Error status: "+i.status+" "+i.statusText+" - Unable to load "+u,i);l&&l(h)}},i.addEventListener("readystatechange",e),i.send()}};m(0)};if(i&&i.enableSceneOffline){let s=e=>{e&&e.status>400?l&&l(e):f()};i.open(()=>{i&&i.loadFile(x.BaseUrl+e,e=>{!c&&t&&t(e),_.onCompleteObservable.notifyObservers(_)},r?e=>{!c&&r&&r(e)}:void 0,s,o)},s)}else f();return _},T=e=>{let{match:t,type:r}=L(e);if(t)return r||void 0;let i=e.lastIndexOf(".");switch(e.substring(i+1).toLowerCase()){case"glb":return"model/gltf-binary";case"bin":return"application/octet-stream";case"gltf":return"model/gltf+json";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";default:return}},R=()=>"undefined"!=typeof location&&"file:"===location.protocol,E=e=>m.test(e),L=e=>{let t=m.exec(e);return null===t||0===t.length?{match:!1,type:""}:{match:!0,type:t[0].replace("data:","").replace("base64,","")}};function U(e){return(0,u.HQ)(e.split(",")[1])}let D=e=>(0,u.rP)(e.split(",")[1]);g.a._FileToolsLoadImage=w,p.an.loadFile=P,c.PM.loadFile=P;let B=(e,t,r,s,n,a,o,l,h,u)=>{Object.defineProperty(i={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:t,DefaultRetryStrategy:r.DefaultRetryStrategy,BaseUrl:r.BaseUrl,CorsBehavior:r.CorsBehavior,PreprocessUrl:r.PreprocessUrl,IsBase64DataUrl:s,IsFileURL:n,LoadFile:a,LoadImage:o,ReadFile:l,RequestFile:h,SetCorsBehavior:u},"DefaultRetryStrategy",{get:function(){return r.DefaultRetryStrategy},set:function(e){r.DefaultRetryStrategy=e}}),Object.defineProperty(i,"BaseUrl",{get:function(){return r.BaseUrl},set:function(e){r.BaseUrl=e}}),Object.defineProperty(i,"PreprocessUrl",{get:function(){return r.PreprocessUrl},set:function(e){r.PreprocessUrl=e}}),Object.defineProperty(i,"CorsBehavior",{get:function(){return r.CorsBehavior},set:function(e){r.CorsBehavior=e}})};B(U,D,x,E,R,P,w,F,A,y)},75916:function(e,t,r){r.d(t,{X:()=>i});class i{}i.FilesToLoad={}},85362:function(e,t,r){function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}r.d(t,{f:()=>i,x:()=>s});let s={RandomId:i}},54037:function(e,t,r){r.d(t,{K:()=>n});var i=r(92550),s=r(86832);class n{static Instantiate(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];let t=(0,s.qw)(e);if(t)return t;i.Y.Warn(e+" not found, you may have missed an import.");let r=e.split("."),n=window||this;for(let e=0,t=r.length;e<t;e++)n=n[r[e]];return"function"!=typeof n?null:n}}n.RegisteredExternalClasses={}},92550:function(e,t,r){r.d(t,{Y:()=>i});class i{static _CheckLimit(e,t){let r=i._LogLimitOutputs[e];return r?r.current++:(r={limit:t,current:1},i._LogLimitOutputs[e]=r),r.current<=r.limit}static _GenerateLimitMessage(e,t=1){let r=i._LogLimitOutputs[e];if(!r||!i.MessageLimitReached)return;let s=this._Levels[t];r.current===r.limit&&i[s.name](i.MessageLimitReached.replace(/%LIMIT%/g,""+r.limit).replace(/%TYPE%/g,s.name??""))}static _AddLogEntry(e){i._LogCache=e+i._LogCache,i.OnNewCacheEntry&&i.OnNewCacheEntry(e)}static _FormatMessage(e){let t=e=>e<10?"0"+e:""+e,r=new Date;return"["+t(r.getHours())+":"+t(r.getMinutes())+":"+t(r.getSeconds())+"]: "+e}static _LogDisabled(e,t){}static _LogEnabled(e=1,t,r){let s=Array.isArray(t)?t[0]:t;if(void 0!==r&&!i._CheckLimit(s,r))return;let n=i._FormatMessage(s),a=this._Levels[e],o=Array.isArray(t)?t.slice(1):[];a.logFunc&&a.logFunc("BJS - "+n,...o);let l=`<div style='color:${a.color}'>${n}</div><br>`;i._AddLogEntry(l),i._GenerateLimitMessage(s,e)}static get LogCache(){return i._LogCache}static ClearLogCache(){i._LogCache="",i._LogLimitOutputs={},i.errorsCount=0}static set LogLevels(e){for(let t of(i.Log=i._LogDisabled,i.Warn=i._LogDisabled,i.Error=i._LogDisabled,[i.MessageLogLevel,i.WarningLogLevel,i.ErrorLogLevel]))(e&t)===t&&(i[this._Levels[t].name]=i._LogEnabled.bind(i,t))}}i.NoneLogLevel=0,i.MessageLogLevel=1,i.WarningLogLevel=2,i.ErrorLogLevel=4,i.AllLogLevel=7,i.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",i._LogCache="",i._LogLimitOutputs={},i._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],i.errorsCount=0,i.Log=i._LogEnabled.bind(i,i.MessageLogLevel),i.Warn=i._LogEnabled.bind(i,i.WarningLogLevel),i.Error=i._LogEnabled.bind(i,i.ErrorLogLevel)},67791:function(e,t,r){r.d(t,{Qj:()=>n,he:()=>s,y$:()=>a});let i="undefined"!=typeof WeakRef;class s{constructor(e,t=!1,r,i){this.initialize(e,t,r,i)}initialize(e,t=!1,r,i){return this.mask=e,this.skipNextObservers=t,this.target=r,this.currentTarget=i,this}}class n{constructor(e,t,r=null){this.callback=e,this.mask=t,this.scope=r,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){this._remove&&this._remove()}}class a{static FromPromise(e,t){let r=new a;return e.then(e=>{r.notifyObservers(e)}).catch(e=>{if(t)t.notifyObservers(e);else throw e}),r}get observers(){return this._observers}constructor(e,t=!1){this.notifyIfTriggered=t,this._observers=[],this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new s(0),e&&(this._onObserverAdded=e)}add(e,t=-1,r=!1,s=null,a=!1){if(!e)return null;let o=new n(e,t,s);o.unregisterOnNextCall=a,r?this._observers.unshift(o):this._observers.push(o),this._onObserverAdded&&this._onObserverAdded(o),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(o,this._lastNotifiedValue);let l=i?new WeakRef(this):{deref:()=>this};return o._remove=()=>{let e=l.deref();e&&e._remove(o)},o}addOnce(e){return this.add(e,void 0,void 0,void 0,!0)}remove(e){return!!e&&(e._remove=null,-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0))}removeCallback(e,t){for(let r=0;r<this._observers.length;r++){let i=this._observers[r];if(!i._willBeUnregistered&&i.callback===e&&(!t||t===i.scope))return this._deferUnregister(i),!0}return!1}_deferUnregister(e){e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0))}_remove(e,t=!0){if(!e)return!1;let r=this._observers.indexOf(e);return -1!==r&&(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(r,1),!0)}makeObserverTopPriority(e){this._remove(e,!1),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e,!1),this._observers.push(e)}notifyObservers(e,t=-1,r,i,s){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;let n=this._eventState;for(let a of(n.mask=t,n.target=r,n.currentTarget=i,n.skipNextObservers=!1,n.lastReturnValue=e,n.userInfo=s,this._observers))if(!a._willBeUnregistered&&(a.mask&t&&(a.unregisterOnNextCall&&this._deferUnregister(a),a.scope?n.lastReturnValue=a.callback.apply(a.scope,[e,n]):n.lastReturnValue=a.callback(e,n)),n.skipNextObservers))return!1;return!0}notifyObserver(e,t,r=-1){if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),e._willBeUnregistered)return;let i=this._eventState;i.mask=r,i.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(t,i)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){let e=this._observers.pop();e&&(e._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){let e=new a;return e._observers=this._observers.slice(0),e}hasSpecificMask(e=-1){for(let t of this._observers)if(t.mask&e||t.mask===e)return!0;return!1}}},53371:function(e,t,r){r.d(t,{F:()=>s});var i=r(82090);class s{static get Now(){return(0,i.CG)()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},32601:function(e,t,r){r.d(t,{b:()=>i});class i{static ExponentialBackoff(e=3,t=500){return(r,i,s)=>0!==i.status||s>=e||-1!==r.indexOf("file:")?-1:Math.pow(2,s)*t}}},3533:function(e,t,r){r.d(t,{Gh:()=>a,HQ:()=>l,Ml:()=>u,Ri:()=>s,fJ:()=>n,gi:()=>i,rP:()=>o,zA:()=>h});let i=(e,t)=>e.endsWith(t),s=(e,t)=>!!e&&e.startsWith(t),n=e=>{if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let r=0;r<e.byteLength;r++)t+=String.fromCharCode(e[r]);return t},a=e=>{let t,r,i,s,n,a,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="",u=0,c=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);for(;u<c.length;)t=c[u++],r=u<c.length?c[u++]:Number.NaN,i=u<c.length?c[u++]:Number.NaN,s=t>>2,n=(3&t)<<4|r>>4,a=(15&r)<<2|i>>6,o=63&i,isNaN(r)?a=o=64:isNaN(i)&&(o=64),h+=l.charAt(s)+l.charAt(n)+l.charAt(a)+l.charAt(o);return h},o=e=>atob(e),l=e=>{let t=o(e),r=t.length,i=new Uint8Array(new ArrayBuffer(r));for(let e=0;e<r;e++)i[e]=t.charCodeAt(e);return i.buffer},h=(e,t)=>{let r=String(e);for(;r.length<t;)r="0"+r;return r},u={EndsWith:i,StartsWith:s,Decode:n,EncodeArrayBufferToBase64:a,DecodeBase64ToString:o,DecodeBase64ToBinary:l,PadNumber:h}},28118:function(e,t,r){r.d(t,{Q:()=>s,r:()=>a});let i=[];class s{static SetImmediate(e){0===i.length&&setTimeout(()=>{let e=i;for(let t of(i=[],e))t()},1),i.push(e)}}function n(e,t,r){try{if(e())return t(),!0}catch(e){return r?.(e),!0}return!1}let a=(e,t,r,i=16,s=3e4,a=!0,o)=>{if(a&&n(e,t,r))return null;let l=setInterval(()=>{n(e,t,r)?clearInterval(l):(s-=i)<0&&(clearInterval(l),r?.(Error("Operation timed out after maximum retries. "+(o||"")),!0))},i);return()=>clearInterval(l)}},12130:function(e,t,r){function i(e){let t=1;do t*=2;while(t<e);return t===e}function s(e,t,r){return e*(1-r)+t*r}function n(e){let t=a(e),r=o(e);return t-e>e-r?r:t}function a(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function o(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)}function l(e,t,r=2){let i;switch(r){case 1:i=o(e);break;case 2:i=n(e);break;default:i=a(e)}return Math.min(i,t)}r.d(t,{Av:()=>o,Tr:()=>n,V2:()=>s,lP:()=>i,p7:()=>l})},60892:function(e,t,r){r.d(t,{$g:()=>b,ok:()=>m,w1:()=>g});var i=r(67791),s=r(82090),n=r(92550),a=r(7375),o=r(53371),l=r(9139),h=r(35011),u=r(66395),c=r(91336),_=r(28118),d=r(54037),f=r(85362),p=r(12130);class g{static get BaseUrl(){return c.rN.BaseUrl}static set BaseUrl(e){c.rN.BaseUrl=e}static get CleanUrl(){return c.rN.CleanUrl}static set CleanUrl(e){c.rN.CleanUrl=e}static IsAbsoluteUrl(e){return 0===e.indexOf("//")||!(-1===e.indexOf("://")||-1===e.indexOf(".")||-1===e.indexOf("/")||e.indexOf(":")>e.indexOf("/"))&&(!!(e.indexOf("://")<e.indexOf("."))||0===e.indexOf("data:")||0===e.indexOf("blob:"))}static set ScriptBaseUrl(e){c.rN.ScriptBaseUrl=e}static get ScriptBaseUrl(){return c.rN.ScriptBaseUrl}static set CDNBaseUrl(e){g.ScriptBaseUrl=e,g.AssetBaseUrl=e}static set ScriptPreprocessUrl(e){c.rN.ScriptPreprocessUrl=e}static get ScriptPreprocessUrl(){return c.rN.ScriptPreprocessUrl}static get DefaultRetryStrategy(){return c.rN.DefaultRetryStrategy}static set DefaultRetryStrategy(e){c.rN.DefaultRetryStrategy=e}static get CorsBehavior(){return c.rN.CorsBehavior}static set CorsBehavior(e){c.rN.CorsBehavior=e}static get UseFallbackTexture(){return u.l.UseFallbackTexture}static set UseFallbackTexture(e){u.l.UseFallbackTexture=e}static get RegisteredExternalClasses(){return d.K.RegisteredExternalClasses}static set RegisteredExternalClasses(e){d.K.RegisteredExternalClasses=e}static get fallbackTexture(){return u.l.FallbackTexture}static set fallbackTexture(e){u.l.FallbackTexture=e}static FetchToRef(e,t,r,i,s,n){let a=((Math.abs(e)*r%r|0)+(Math.abs(t)*i%i|0)*r)*4;n.r=s[a]/255,n.g=s[a+1]/255,n.b=s[a+2]/255,n.a=s[a+3]/255}static Mix(e,t,r){return 0}static Instantiate(e){return d.K.Instantiate(e)}static SetImmediate(e){_.Q.SetImmediate(e)}static IsExponentOfTwo(e){return!0}static FloatRound(e){return Math.fround(e)}static GetFilename(e){let t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)}static GetFolderPath(e,t=!1){let r=e.lastIndexOf("/");return r<0?t?e:"":e.substring(0,r+1)}static ToDegrees(e){return 180*e/Math.PI}static ToRadians(e){return e*Math.PI/180}static SmoothAngleChange(e,t,r=.9){let i=this.ToRadians(e),s=this.ToRadians(t);return this.ToDegrees(Math.atan2((1-r)*Math.sin(s)+r*Math.sin(i),(1-r)*Math.cos(s)+r*Math.cos(i)))}static MakeArray(e,t){return!0!==t&&(void 0===e||null==e)?null:Array.isArray(e)?e:[e]}static GetPointerPrefix(e){return(0,s.CG)()&&!window.PointerEvent?"mouse":"pointer"}static SetCorsBehavior(e,t){(0,c.$M)(e,t)}static SetReferrerPolicyBehavior(e,t){t.referrerPolicy=e}static get PreprocessUrl(){return c.rN.PreprocessUrl}static set PreprocessUrl(e){c.rN.PreprocessUrl=e}static LoadImage(e,t,r,i,s,n){return(0,c.r6)(e,t,r,i,s,n)}static LoadFile(e,t,r,i,s,n){return(0,c.vP)(e,t,r,i,s,n)}static LoadFileAsync(e,t=!0){return new Promise((r,i)=>{(0,c.vP)(e,e=>{r(e)},void 0,void 0,t,(e,t)=>{i(t)})})}static GetAssetUrl(e){if(!e)return"";if(g.AssetBaseUrl&&e.startsWith(g._DefaultAssetsUrl)){let t="/"===g.AssetBaseUrl[g.AssetBaseUrl.length-1]?g.AssetBaseUrl.substring(0,g.AssetBaseUrl.length-1):g.AssetBaseUrl;return e.replace(g._DefaultAssetsUrl,t)}return e}static GetBabylonScriptURL(e,t){if(!e)return"";if(g.ScriptBaseUrl&&e.startsWith(g._DefaultCdnUrl)){let t="/"===g.ScriptBaseUrl[g.ScriptBaseUrl.length-1]?g.ScriptBaseUrl.substring(0,g.ScriptBaseUrl.length-1):g.ScriptBaseUrl;e=e.replace(g._DefaultCdnUrl,t)}return e=g.ScriptPreprocessUrl(e),t&&(e=g.GetAbsoluteUrl(e)),e}static LoadBabylonScript(e,t,r,i){e=g.GetBabylonScriptURL(e),g.LoadScript(e,t,r)}static LoadBabylonScriptAsync(e){return e=g.GetBabylonScriptURL(e),g.LoadScriptAsync(e)}static LoadScript(e,t,r,i,n=!1){if("function"==typeof importScripts){try{importScripts(e),t&&t()}catch(t){r?.(`Unable to load script '${e}' in worker`,t)}return}if(!(0,s.CG)())return void r?.(`Cannot load script '${e}' outside of a window or a worker`);let a=document.getElementsByTagName("head")[0],o=document.createElement("script");n?(o.setAttribute("type","module"),o.innerText=e):(o.setAttribute("type","text/javascript"),o.setAttribute("src",e)),i&&(o.id=i),o.onload=()=>{t&&t()},o.onerror=t=>{r&&r(`Unable to load script '${e}'`,t)},a.appendChild(o)}static LoadScriptAsync(e,t){return new Promise((r,i)=>{this.LoadScript(e,()=>{r()},(e,t)=>{i(t||Error(e))},t)})}static ReadFileAsDataURL(e,t,r){let s=new FileReader,n={onCompleteObservable:new i.y$,abort:()=>s.abort()};return s.onloadend=()=>{n.onCompleteObservable.notifyObservers(n)},s.onload=e=>{t(e.target.result)},s.onprogress=r,s.readAsDataURL(e),n}static ReadFile(e,t,r,i,s){return(0,c.Ip)(e,t,r,i,s)}static FileAsURL(e){let t=new Blob([e]);return window.URL.createObjectURL(t)}static Format(e,t=2){return e.toFixed(t)}static DeepCopy(e,t,r,i){a.j.DeepCopy(e,t,r,i)}static IsEmpty(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}static RegisterTopRootEvents(e,t){for(let r=0;r<t.length;r++){let i=t[r];e.addEventListener(i.name,i.handler,!1);try{window.parent&&window.parent.addEventListener(i.name,i.handler,!1)}catch(e){}}}static UnregisterTopRootEvents(e,t){for(let r=0;r<t.length;r++){let i=t[r];e.removeEventListener(i.name,i.handler);try{e.parent&&e.parent.removeEventListener(i.name,i.handler)}catch(e){}}}static async DumpFramebuffer(e,t,r,i,s="image/png",n,a){throw(0,l.S)("DumpTools")}static DumpData(e,t,r,i,s="image/png",n,a=!1,o=!1,h){throw(0,l.S)("DumpTools")}static DumpDataAsync(e,t,r,i="image/png",s,n=!1,a=!1,o){throw(0,l.S)("DumpTools")}static _IsOffScreenCanvas(e){return void 0!==e.convertToBlob}static ToBlob(e,t,r="image/png",i){g._IsOffScreenCanvas(e)||e.toBlob||(e.toBlob=function(e,t,r){setTimeout(()=>{let i=atob(this.toDataURL(t,r).split(",")[1]),s=i.length,n=new Uint8Array(s);for(let e=0;e<s;e++)n[e]=i.charCodeAt(e);e(new Blob([n]))})}),g._IsOffScreenCanvas(e)?e.convertToBlob({type:r,quality:i}).then(e=>t(e)):e.toBlob(function(e){t(e)},r,i)}static DownloadBlob(e,t){if("download"in document.createElement("a")){if(!t){let e=new Date;t="screenshot_"+((e.getFullYear()+"-"+(e.getMonth()+1)).slice(2)+"-"+e.getDate()+"_"+e.getHours()+"-")+("0"+e.getMinutes()).slice(-2)+".png"}g.Download(e,t)}else if(e&&"undefined"!=typeof URL){let t=URL.createObjectURL(e),r=window.open("");if(!r)return;let i=r.document.createElement("img");i.onload=function(){URL.revokeObjectURL(t)},i.src=t,r.document.body.appendChild(i)}}static EncodeScreenshotCanvasData(e,t,r="image/png",i,s){if("string"!=typeof i&&t){if(t){if(g._IsOffScreenCanvas(e))return void e.convertToBlob({type:r,quality:s}).then(e=>{let r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{t(r.result)}});t(e.toDataURL(r,s))}}else this.ToBlob(e,function(e){e&&g.DownloadBlob(e,i),t&&t("")},r,s)}static Download(e,t){if("undefined"==typeof URL)return;let r=window.URL.createObjectURL(e),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=r,i.download=t,i.addEventListener("click",()=>{i.parentElement&&i.parentElement.removeChild(i)}),i.click(),window.URL.revokeObjectURL(r)}static BackCompatCameraNoPreventDefault(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]}static CreateScreenshot(e,t,r,i,s="image/png",n=!1,a){throw(0,l.S)("ScreenshotTools")}static CreateScreenshotAsync(e,t,r,i="image/png",s){throw(0,l.S)("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(e,t,r,i,s="image/png",n=1,a=!1,o,h=!1,u=!1,c=!0,_,d){throw(0,l.S)("ScreenshotTools")}static CreateScreenshotUsingRenderTargetAsync(e,t,r,i="image/png",s=1,n=!1,a,o=!1,h=!1,u=!0,c,_){throw(0,l.S)("ScreenshotTools")}static RandomId(){return(0,f.f)()}static IsBase64(e){return(0,c.VL)(e)}static DecodeBase64(e){return(0,c.$K)(e)}static get errorsCount(){return n.Y.errorsCount}static Log(e){n.Y.Log(e)}static Warn(e){n.Y.Warn(e)}static Error(e){n.Y.Error(e)}static get LogCache(){return n.Y.LogCache}static ClearLogCache(){n.Y.ClearLogCache()}static set LogLevels(e){n.Y.LogLevels=e}static set PerformanceLogLevel(e){if((e&g.PerformanceUserMarkLogLevel)===g.PerformanceUserMarkLogLevel){g.StartPerformanceCounter=g._StartUserMark,g.EndPerformanceCounter=g._EndUserMark;return}if((e&g.PerformanceConsoleLogLevel)===g.PerformanceConsoleLogLevel){g.StartPerformanceCounter=g._StartPerformanceConsole,g.EndPerformanceCounter=g._EndPerformanceConsole;return}g.StartPerformanceCounter=g._StartPerformanceCounterDisabled,g.EndPerformanceCounter=g._EndPerformanceCounterDisabled}static _StartPerformanceCounterDisabled(e,t){}static _EndPerformanceCounterDisabled(e,t){}static _StartUserMark(e,t=!0){if(!g._Performance){if(!(0,s.CG)())return;g._Performance=window.performance}t&&g._Performance.mark&&g._Performance.mark(e+"-Begin")}static _EndUserMark(e,t=!0){t&&g._Performance.mark&&(g._Performance.mark(e+"-End"),g._Performance.measure(e,e+"-Begin",e+"-End"))}static _StartPerformanceConsole(e,t=!0){t&&(g._StartUserMark(e,t),console.time&&console.time(e))}static _EndPerformanceConsole(e,t=!0){t&&(g._EndUserMark(e,t),console.timeEnd(e))}static get Now(){return o.F.Now}static GetClassName(e,t=!1){let r=null;return!t&&e.getClassName?r=e.getClassName():(e instanceof Object&&(r=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__),r||(r=typeof e)),r}static First(e,t){for(let r of e)if(t(r))return r;return null}static getFullClassName(e,t=!1){let r=null,i=null;if(!t&&e.getClassName)r=e.getClassName();else{if(e instanceof Object){let s=t?e:Object.getPrototypeOf(e);r=s.constructor.__bjsclassName__,i=s.constructor.__bjsmoduleName__}r||(r=typeof e)}return r?(null!=i?i+".":"")+r:null}static DelayAsync(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}static IsSafari(){return!!(0,s.up)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}function m(e,t){return r=>{r.__bjsclassName__=e,r.__bjsmoduleName__=null!=t?t:null}}g.AssetBaseUrl="",g.UseCustomRequestHeaders=!1,g.CustomRequestHeaders=h.g.CustomRequestHeaders,g.GetDOMTextContent=s.v,g._DefaultCdnUrl="https://cdn.babylonjs.com",g._DefaultAssetsUrl="https://assets.babylonjs.com/core",g.GetAbsoluteUrl="object"==typeof document?e=>{let t=document.createElement("a");return t.href=e,t.href}:"function"==typeof URL&&"object"==typeof location?e=>new URL(e,location.origin).href:()=>{throw Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},g.NoneLogLevel=n.Y.NoneLogLevel,g.MessageLogLevel=n.Y.MessageLogLevel,g.WarningLogLevel=n.Y.WarningLogLevel,g.ErrorLogLevel=n.Y.ErrorLogLevel,g.AllLogLevel=n.Y.AllLogLevel,g.IsWindowObjectExist=s.CG,g.PerformanceNoneLogLevel=0,g.PerformanceUserMarkLogLevel=1,g.PerformanceConsoleLogLevel=2,g.StartPerformanceCounter=g._StartPerformanceCounterDisabled,g.EndPerformanceCounter=g._EndPerformanceCounterDisabled;class b{constructor(e,t,r,i=0){this.iterations=e,this.index=i-1,this._done=!1,this._fn=t,this._successCallback=r}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(e,t,r,i=0){let s=new b(e,t,r,i);return s.executeNext(),s}static SyncAsyncForLoop(e,t,r,i,s,n=0){return b.Run(Math.ceil(e/t),i=>{s&&s()?i.breakLoop():setTimeout(()=>{for(let n=0;n<t;++n){let a=i.index*t+n;if(a>=e)break;if(r(a),s&&s()){i.breakLoop();break}}i.executeNext()},n)},i)}}g.Mix=p.V2,g.IsExponentOfTwo=p.lP,u.l.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},86832:function(e,t,r){r.d(t,{H7:()=>s,Yt:()=>a,qw:()=>n});let i={};function s(e,t){i[e]=t}function n(e){return i[e]}function a(e){for(let t in i)if(e instanceof i[t]&&!t.includes("Abstract"))return t;return"Unknown"}},35011:function(e,t,r){r.d(t,{g:()=>i});class i{constructor(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}static get IsCustomRequestAvailable(){return Object.keys(i.CustomRequestHeaders).length>0||i.CustomRequestModifiers.length>0}get requestURL(){return this._requestURL}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(let e in i.CustomRequestHeaders){let t=i.CustomRequestHeaders[e];t&&this._xhr.setRequestHeader(e,t)}}_shouldSkipRequestModifications(e){return i.SkipRequestModificationForBabylonCDN&&(e.includes("preview.babylonjs.com")||e.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(e){this._xhr.onprogress=e}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(e){this._xhr.responseType=e}get timeout(){return this._xhr.timeout}set timeout(e){this._xhr.timeout=e}addEventListener(e,t,r){this._xhr.addEventListener(e,t,r)}removeEventListener(e,t,r){this._xhr.removeEventListener(e,t,r)}abort(){this._xhr.abort()}send(e){i.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(e)}open(e,t){for(let e of i.CustomRequestModifiers){if(this._shouldSkipRequestModifications(t))return;t=e(this._xhr,t)||t}t=(t=t.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=t,this._xhr.open(e,t,!0)}setRequestHeader(e,t){this._xhr.setRequestHeader(e,t)}getResponseHeader(e){return this._xhr.getResponseHeader(e)}}i.CustomRequestHeaders={},i.CustomRequestModifiers=[],i.SkipRequestModificationForBabylonCDN=!0},80982:function(e,t,r){r.d(t,{Q:()=>i});class i{constructor(){this._blendFunctionParameters=[,,,,],this._blendEquationParameters=[,,],this._blendConstants=[,,,,],this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(e,t,r,i){(this._blendConstants[0]!==e||this._blendConstants[1]!==t||this._blendConstants[2]!==r||this._blendConstants[3]!==i)&&(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=r,this._blendConstants[3]=i,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(e,t,r,i){(this._blendFunctionParameters[0]!==e||this._blendFunctionParameters[1]!==t||this._blendFunctionParameters[2]!==r||this._blendFunctionParameters[3]!==i)&&(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=r,this._blendFunctionParameters[3]=i,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(e,t){(this._blendEquationParameters[0]!==e||this._blendEquationParameters[1]!==t)&&(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}},33149:function(e,t,r){r.d(t,{k:()=>i});class i{constructor(e=!0){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}},77203:function(e,t,r){r.d(t,{s:()=>i});class i{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=i.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=i.KEEP,this.opDepthFail=i.KEEP,this.opStencilDepthPass=i.REPLACE}get stencilFunc(){return this.func}set stencilFunc(e){this.func=e}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(e){this.funcRef=e}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(e){this.funcMask=e}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(e){this.opStencilFail=e}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(e){this.opDepthFail=e}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(e){this.opStencilDepthPass=e}get stencilMask(){return this.mask}set stencilMask(e){this.mask=e}get stencilTest(){return this.enabled}set stencilTest(e){this.enabled=e}}i.ALWAYS=519,i.KEEP=7680,i.REPLACE=7681},51210:function(e,t,r){r.d(t,{C:()=>i});class i{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)}constructor(e=!0){this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}reset(){this.stencilMaterial=void 0,this.stencilGlobal?.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(e){if(!e)return;let t=!this.useStencilGlobalOnly&&!!this.stencilMaterial?.enabled;this.enabled=t?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=t?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=t?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=t?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=t?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=t?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=t?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=t?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}},61693:function(e,t,r){var i=r(55845);e.exports=r.v(t,e.id,"45fd843558b43de4",{"./terrain_generation_bg.js":{__wbindgen_copy_to_typed_array:i.T2,__wbindgen_object_drop_ref:i.ug,__wbindgen_throw:i.Or}})}}]);